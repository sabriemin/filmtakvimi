<!DOCTYPE html>

<html lang="tr">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>🎬 Admin Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script><script>
// Sayfa giriş kontrolü
window.addEventListener("DOMContentLoaded", function () {
  const token = localStorage.getItem("admin_token");
  if (token !== "gizli-sifrem") {
    window.location.href = "index.html";
  } else {
    logAdminAccess();
  }
});

// Loglama işlemi
function logAdminAccess() {
  fetch("/admin-log", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      time: new Date().toISOString(),
      userAgent: navigator.userAgent
    })
  }).then(() => {
    console.log("✅ Admin erişimi loglandı.");
  }).catch(() => {
    console.warn("⚠️ Admin log gönderilemedi.");
  });
}
</script><script>
// admin.html erişim kontrolü
window.addEventListener("DOMContentLoaded", function () {
  const loggedIn = sessionStorage.getItem("admin_logged_in");
  if (loggedIn !== "true") {
    window.location.href = "admin_login.html";
  }
});
</script>
</head>
<body class="bg-gray-900 text-white font-sans">
<!-- Navbar -->
<nav class="bg-gray-800 p-4 flex justify-between items-center shadow-md">
<h1 class="text-xl font-bold text-yellow-400">🎬 Film Takvimi | Admin Panel</h1>
<button class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded font-semibold text-white" onclick="logout()">Çıkış Yap</button>
</nav>
<!-- Dashboard Container -->
<div class="max-w-6xl mx-auto p-6 space-y-6">
<!-- Stats -->
<section class="bg-gray-800 p-4 rounded shadow">
<h2 class="text-lg font-bold mb-2 text-blue-400">📊 Genel İstatistikler</h2>
<div class="text-sm text-gray-300" id="stats-box">
        ⏳ Yükleniyor...
      </div>
</section>
<!-- Chart -->
<section class="bg-gray-800 p-4 rounded shadow">
<div class="flex justify-between items-center mb-2">
<h2 class="text-lg font-bold text-purple-400">📈 Günlük İndirme Grafiği</h2>
<div class="space-x-2 text-sm">
<input class="bg-gray-700 rounded px-2 py-1 text-white" id="start-date" type="date"/>
<input class="bg-gray-700 rounded px-2 py-1 text-white" id="end-date" type="date"/>
<button class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded" onclick="filterChart()">Filtrele</button>
</div>
</div>
<canvas height="120" id="downloadChart"></canvas>
</section>
<!-- Preview -->
<!-- Manuel Tetikleme -->
<section class="bg-gray-800 p-4 rounded shadow text-center">
<h2 class="text-lg font-bold text-green-400 mb-2">🔁 Manuel Güncelle</h2>
<p class="text-sm text-gray-400 mb-4">Film takvimi verilerini yeniden oluştur.</p>
<button class="bg-green-600 hover:bg-green-700 px-6 py-2 rounded font-semibold" onclick="triggerUpdate()">↻ Takvimi Güncelle</button>
<p class="mt-2 text-sm text-gray-400" id="update-msg"></p>
</section>
</div>
</body>
</html>