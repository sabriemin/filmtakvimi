<!DOCTYPE html>

<html lang="tr" x-data="app()" x-init="init()">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>ðŸŽ¬ Film Evreni AÄŸÄ±</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/shepherd.js@8.4.1/dist/js/shepherd.min.js"></script>
<script>
/*! shepherd.js 8.1.0 */

'use strict';(function(E,Y){"object"===typeof exports&&"undefined"!==typeof module?module.exports=Y():"function"===typeof define&&define.amd?define(Y):(E="undefined"!==typeof globalThis?globalThis:E||self,E.Shepherd=Y())})(this,function(){function E(a,b){return!1!==b.clone&&b.isMergeableObject(a)?S(Array.isArray(a)?[]:{},a,b):a}function Y(a,b,c){return a.concat(b).map(function(a){return E(a,c)})}function ob(a){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(a).filter(function(b){return a.propertyIsEnumerable(b)}):
[]}function Fa(a){return Object.keys(a).concat(ob(a))}function Ga(a,b){try{return b in a}catch(c){return!1}}function pb(a,b,c){var d={};c.isMergeableObject(a)&&Fa(a).forEach(function(b){d[b]=E(a[b],c)});Fa(b).forEach(function(e){if(!Ga(a,e)||Object.hasOwnProperty.call(a,e)&&Object.propertyIsEnumerable.call(a,e))if(Ga(a,e)&&c.isMergeableObject(b[e])){if(c.customMerge){var f=c.customMerge(e);f="function"===typeof f?f:S}else f=S;d[e]=f(a[e],b[e],c)}else d[e]=E(b[e],c)});return d}function S(a,b,c){c=
c||{};c.arrayMerge=c.arrayMerge||Y;c.isMergeableObject=c.isMergeableObject||qb;c.cloneUnlessOtherwiseSpecified=E;var d=Array.isArray(b),e=Array.isArray(a);return d!==e?E(b,c):d?c.arrayMerge(a,b,c):pb(a,b,c)}function T(a){return"function"===typeof a}function Z(a){return"string"===typeof a}function Ha(a){let b=Object.getOwnPropertyNames(a.constructor.prototype);for(let c=0;c<b.length;c++){let d=b[c],e=a[d];"constructor"!==d&&"function"===typeof e&&(a[d]=e.bind(a))}return a}function rb(a,b){return c=>
{if(b.isOpen()){let d=b.el&&c.currentTarget===b.el;(void 0!==a&&c.currentTarget.matches(a)||d)&&b.tour.next()}}}function sb(a){let {event:b,selector:c}=a.options.advanceOn||{};if(b){let d=rb(c,a),e;try{e=document.querySelector(c)}catch(f){}if(void 0===c||e)e?(e.addEventListener(b,d),a.on("destroy",()=>e.removeEventListener(b,d))):(document.body.addEventListener(b,d,!0),a.on("destroy",()=>document.body.removeEventListener(b,d,!0)));else return console.error(`No element was found for the selector supplied to advanceOn: ${c}`)}else return console.error("advanceOn was defined, but no event name was passed.")}
function x(a){return a?(a.nodeName||"").toLowerCase():null}function z(a){return"[object Window]"!==a.toString()?(a=a.ownerDocument)?a.defaultView||window:window:a}function aa(a){var b=z(a).Element;return a instanceof b||a instanceof Element}function B(a){var b=z(a).HTMLElement;return a instanceof b||a instanceof HTMLElement}function C(a){return a.split("-")[0]}function qa(a){return{x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}}function Ia(a,b){var c=b.getRootNode&&b.getRootNode();
c=!(!c||!c.host);if(a.contains(b))return!0;if(c){do{if(b&&a.isSameNode(b))return!0;b=b.parentNode||b.host}while(b)}return!1}function F(a){return z(a).getComputedStyle(a)}function G(a){return((aa(a)?a.ownerDocument:a.document)||window.document).documentElement}function ja(a){return"html"===x(a)?a:a.assignedSlot||a.parentNode||a.host||G(a)}function Ja(a){if(!B(a)||"fixed"===F(a).position)return null;if(a=a.offsetParent){var b=G(a);if("body"===x(a)&&"static"===F(a).position&&"static"!==F(b).position)return b}return a}
function ba(a){for(var b=z(a),c=Ja(a);c&&0<=["table","td","th"].indexOf(x(c))&&"static"===F(c).position;)c=Ja(c);if(c&&"body"===x(c)&&"static"===F(c).position)return b;if(!c)a:{for(a=ja(a);B(a)&&0>["html","body"].indexOf(x(a));)if(c=F(a),"none"!==c.transform||"none"!==c.perspective||c.willChange&&"auto"!==c.willChange){c=a;break a}else a=a.parentNode;c=null}return c||b}function ra(a){return 0<=["top","bottom"].indexOf(a)?"x":"y"}function Ka(a){return Object.assign(Object.assign({},{top:0,right:0,
bottom:0,left:0}),a)}function La(a,b){return b.reduce(function(b,d){b[d]=a;return b},{})}function Ma(a){var b,c=a.popper,d=a.popperRect,e=a.placement,f=a.offsets,h=a.position,k=a.gpuAcceleration,m=a.adaptive,g=window.devicePixelRatio||1;a=Math.round(f.x*g)/g||0;g=Math.round(f.y*g)/g||0;var l=f.hasOwnProperty("x");f=f.hasOwnProperty("y");var p="left",t="top",y=window;if(m){var A=ba(c);A===z(c)&&(A=G(c));"top"===e&&(t="bottom",g-=A.clientHeight-d.height,g*=k?1:-1);"left"===e&&(p="right",a-=A.clientWidth-
d.width,a*=k?1:-1)}c=Object.assign({position:h},m&&tb);if(k){var u;return Object.assign(Object.assign({},c),{},(u={},u[t]=f?"0":"",u[p]=l?"0":"",u.transform=2>(y.devicePixelRatio||1)?"translate("+a+"px, "+g+"px)":"translate3d("+a+"px, "+g+"px, 0)",u))}return Object.assign(Object.assign({},c),{},(b={},b[t]=f?g+"px":"",b[p]=l?a+"px":"",b.transform="",b))}function ka(a){return a.replace(/left|right|bottom|top/g,function(a){return ub[a]})}function Na(a){return a.replace(/start|end/g,function(a){return vb[a]})}
function ca(a){a=a.getBoundingClientRect();return{width:a.width,height:a.height,top:a.top,right:a.right,bottom:a.bottom,left:a.left,x:a.left,y:a.top}}function sa(a){a=z(a);return{scrollLeft:a.pageXOffset,scrollTop:a.pageYOffset}}function ta(a){return ca(G(a)).left+sa(a).scrollLeft}function ua(a){a=F(a);return/auto|scroll|overlay|hidden/.test(a.overflow+a.overflowY+a.overflowX)}function Oa(a){return 0<=["html","body","#document"].indexOf(x(a))?a.ownerDocument.body:B(a)&&ua(a)?a:Oa(ja(a))}function da(a,
b){void 0===b&&(b=[]);var c=Oa(a);a="body"===x(c);var d=z(c);c=a?[d].concat(d.visualViewport||[],ua(c)?c:[]):c;b=b.concat(c);return a?b:b.concat(da(ja(c)))}function va(a){return Object.assign(Object.assign({},a),{},{left:a.x,top:a.y,right:a.x+a.width,bottom:a.y+a.height})}function Pa(a,b){if("viewport"===b){b=z(a);var c=G(a);b=b.visualViewport;var d=c.clientWidth;c=c.clientHeight;var e=0,f=0;b&&(d=b.width,c=b.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(e=b.offsetLeft,f=b.offsetTop));
a={width:d,height:c,x:e+ta(a),y:f};a=va(a)}else B(b)?(a=ca(b),a.top+=b.clientTop,a.left+=b.clientLeft,a.bottom=a.top+b.clientHeight,a.right=a.left+b.clientWidth,a.width=b.clientWidth,a.height=b.clientHeight,a.x=a.left,a.y=a.top):(f=G(a),a=G(f),e=sa(f),b=f.ownerDocument.body,d=Math.max(a.scrollWidth,a.clientWidth,b?b.scrollWidth:0,b?b.clientWidth:0),c=Math.max(a.scrollHeight,a.clientHeight,b?b.scrollHeight:0,b?b.clientHeight:0),f=-e.scrollLeft+ta(f),e=-e.scrollTop,"rtl"===F(b||a).direction&&(f+=Math.max(a.clientWidth,
b?b.clientWidth:0)-d),a=va({width:d,height:c,x:f,y:e}));return a}function wb(a){var b=da(ja(a)),c=0<=["absolute","fixed"].indexOf(F(a).position)&&B(a)?ba(a):a;return aa(c)?b.filter(function(a){return aa(a)&&Ia(a,c)&&"body"!==x(a)}):[]}function xb(a,b,c){b="clippingParents"===b?wb(a):[].concat(b);c=[].concat(b,[c]);c=c.reduce(function(b,c){c=Pa(a,c);b.top=Math.max(c.top,b.top);b.right=Math.min(c.right,b.right);b.bottom=Math.min(c.bottom,b.bottom);b.left=Math.max(c.left,b.left);return b},Pa(a,c[0]));
c.width=c.right-c.left;c.height=c.bottom-c.top;c.x=c.left;c.y=c.top;return c}function Qa(a){var b=a.reference,c=a.element,d=(a=a.placement)?C(a):null;a=a?a.split("-")[1]:null;var e=b.x+b.width/2-c.width/2,f=b.y+b.height/2-c.height/2;switch(d){case "top":e={x:e,y:b.y-c.height};break;case "bottom":e={x:e,y:b.y+b.height};break;case "right":e={x:b.x+b.width,y:f};break;case "left":e={x:b.x-c.width,y:f};break;default:e={x:b.x,y:b.y}}d=d?ra(d):null;if(null!=d)switch(f="y"===d?"height":"width",a){case "start":e[d]=
Math.floor(e[d])-Math.floor(b[f]/2-c[f]/2);break;case "end":e[d]=Math.floor(e[d])+Math.ceil(b[f]/2-c[f]/2)}return e}function ea(a,b){void 0===b&&(b={});var c=b;b=c.placement;b=void 0===b?a.placement:b;var d=c.boundary,e=void 0===d?"clippingParents":d;d=c.rootBoundary;var f=void 0===d?"viewport":d;d=c.elementContext;d=void 0===d?"popper":d;var h=c.altBoundary,k=void 0===h?!1:h;c=c.padding;c=void 0===c?0:c;c=Ka("number"!==typeof c?c:La(c,fa));var m=a.elements.reference;h=a.rects.popper;k=a.elements[k?
"popper"===d?"reference":"popper":d];e=xb(aa(k)?k:k.contextElement||G(a.elements.popper),e,f);f=ca(m);k=Qa({reference:f,element:h,strategy:"absolute",placement:b});h=va(Object.assign(Object.assign({},h),k));f="popper"===d?h:f;var g={top:e.top-f.top+c.top,bottom:f.bottom-e.bottom+c.bottom,left:e.left-f.left+c.left,right:f.right-e.right+c.right};a=a.modifiersData.offset;if("popper"===d&&a){var l=a[b];Object.keys(g).forEach(function(a){var b=0<=["right","bottom"].indexOf(a)?1:-1,c=0<=["top","bottom"].indexOf(a)?
"y":"x";g[a]+=l[c]*b})}return g}function yb(a,b){void 0===b&&(b={});var c=b.boundary,d=b.rootBoundary,e=b.padding,f=b.flipVariations,h=b.allowedAutoPlacements,k=void 0===h?Ra:h,m=b.placement.split("-")[1];b=m?f?Sa:Sa.filter(function(a){return a.split("-")[1]===m}):fa;f=b.filter(function(a){return 0<=k.indexOf(a)});0===f.length&&(f=b);var g=f.reduce(function(b,f){b[f]=ea(a,{placement:f,boundary:c,rootBoundary:d,padding:e})[C(f)];return b},{});return Object.keys(g).sort(function(a,b){return g[a]-g[b]})}
function zb(a){if("auto"===C(a))return[];var b=ka(a);return[Na(a),b,Na(b)]}function Ta(a,b,c){void 0===c&&(c={x:0,y:0});return{top:a.top-b.height-c.y,right:a.right-b.width+c.x,bottom:a.bottom-b.height+c.y,left:a.left-b.width-c.x}}function Ua(a){return["top","right","bottom","left"].some(function(b){return 0<=a[b]})}function Ab(a,b,c){void 0===c&&(c=!1);var d=G(b);a=ca(a);var e=B(b),f={scrollLeft:0,scrollTop:0},h={x:0,y:0};if(e||!e&&!c){if("body"!==x(b)||ua(d))f=b!==z(b)&&B(b)?{scrollLeft:b.scrollLeft,
scrollTop:b.scrollTop}:sa(b);B(b)?(h=ca(b),h.x+=b.clientLeft,h.y+=b.clientTop):d&&(h.x=ta(d))}return{x:a.left+f.scrollLeft-h.x,y:a.top+f.scrollTop-h.y,width:a.width,height:a.height}}function Bb(a){function b(a){d.add(a.name);[].concat(a.requires||[],a.requiresIfExists||[]).forEach(function(a){d.has(a)||(a=c.get(a))&&b(a)});e.push(a)}var c=new Map,d=new Set,e=[];a.forEach(function(a){c.set(a.name,a)});a.forEach(function(a){d.has(a.name)||b(a)});return e}function Cb(a){var b=Bb(a);return Db.reduce(function(a,
d){return a.concat(b.filter(function(a){return a.phase===d}))},[])}function Eb(a){var b;return function(){b||(b=new Promise(function(c){Promise.resolve().then(function(){b=void 0;c(a())})}));return b}}function Fb(a){var b=a.reduce(function(a,b){var c=a[b.name];a[b.name]=c?Object.assign(Object.assign(Object.assign({},c),b),{},{options:Object.assign(Object.assign({},c.options),b.options),data:Object.assign(Object.assign({},c.data),b.data)}):b;return a},{});return Object.keys(b).map(function(a){return b[a]})}
function Va(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return!b.some(function(a){return!(a&&"function"===typeof a.getBoundingClientRect)})}function wa(){wa=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],d;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};return wa.apply(this,arguments)}function Gb(){return[{name:"applyStyles",fn({state:a}){Object.keys(a.elements).forEach(b=>{if("popper"===b){var c=a.attributes[b]||
{},d=a.elements[b];Object.assign(d.style,{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)"});Object.keys(c).forEach(a=>{let b=c[a];!1===b?d.removeAttribute(a):d.setAttribute(a,!0===b?"":b)})}})}},{name:"computeStyles",options:{adaptive:!1}}]}function Hb(a){let b=Gb(),c={placement:"top",strategy:"fixed",modifiers:[{name:"focusAfterRender",enabled:!0,phase:"afterWrite",fn(){setTimeout(()=>{a.el&&a.el.focus()},300)}}]};return c=wa({},c,{modifiers:Array.from(new Set([...c.modifiers,
...b]))})}function Wa(a){return Z(a)&&""!==a?"-"!==a.charAt(a.length-1)?`${a}-`:a:""}function xa(a){a=a.options.attachTo||{};let b=Object.assign({},a);if(Z(a.element)){try{b.element=document.querySelector(a.element)}catch(c){}b.element||console.error(`The element for this Shepherd step was not found ${a.element}`)}return b}function ya(){let a=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,b=>{let c=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"==b?c:c&3|8).toString(16)})}
function Ib(a,b){let c={modifiers:[{name:"preventOverflow",options:{altAxis:!0}},{name:"focusAfterRender",enabled:!0,phase:"afterWrite",fn(){setTimeout(()=>{b.el&&b.el.focus()},300)}}],strategy:"absolute"};b.isCentered()?c=Hb(b):c.placement=a.on;(a=b.tour&&b.tour.options&&b.tour.options.defaultStepOptions)&&(c=Xa(a,c));return c=Xa(b.options,c)}function Xa(a,b){if(a.popperOptions){let c=Object.assign({},b,a.popperOptions);if(a.popperOptions.modifiers&&0<a.popperOptions.modifiers.length){let d=a.popperOptions.modifiers.map(a=>
a.name);b=b.modifiers.filter(a=>!d.includes(a.name));c.modifiers=Array.from(new Set([...b,...a.popperOptions.modifiers]))}return c}return b}function v(){}function Jb(a,b){for(let c in b)a[c]=b[c];return a}function U(a){return a()}function Ya(a){return"function"===typeof a}function H(a,b){return a!=a?b==b:a!==b||a&&"object"===typeof a||"function"===typeof a}function w(a){a.parentNode.removeChild(a)}function Za(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function la(a,b,c,d){a.addEventListener(b,
c,d);return()=>a.removeEventListener(b,c,d)}function q(a,b,c){null==c?a.removeAttribute(b):a.getAttribute(b)!==c&&a.setAttribute(b,c)}function $a(a,b){let c=Object.getOwnPropertyDescriptors(a.__proto__);for(let d in b)null==b[d]?a.removeAttribute(d):"style"===d?a.style.cssText=b[d]:"__value"===d?a.value=a[d]=b[d]:c[d]&&c[d].set?a[d]=b[d]:q(a,d,b[d])}function V(a,b,c){a.classList[c?"add":"remove"](b)}function ma(){if(!N)throw Error("Function called outside component initialization");return N}function za(a){na.push(a)}
function ab(){if(!Aa){Aa=!0;do{for(var a=0;a<ha.length;a+=1){var b=ha[a];N=b;b=b.$$;if(null!==b.fragment){b.update();b.before_update.forEach(U);let a=b.dirty;b.dirty=[-1];b.fragment&&b.fragment.p(b.ctx,a);b.after_update.forEach(za)}}N=null;for(ha.length=0;W.length;)W.pop()();for(a=0;a<na.length;a+=1)b=na[a],Ba.has(b)||(Ba.add(b),b());na.length=0}while(ha.length);for(;bb.length;)bb.pop()();Aa=Ca=!1;Ba.clear()}}function O(){P={r:0,c:[],p:P}}function Q(){P.r||P.c.forEach(U);P=P.p}function n(a,b){a&&
a.i&&(oa.delete(a),a.i(b))}function r(a,b,c,d){a&&a.o&&!oa.has(a)&&(oa.add(a),P.c.push(()=>{oa.delete(a);d&&(c&&a.d(1),d())}),a.o(b))}function R(a){a&&a.c()}function L(a,b,c){let {fragment:d,on_mount:e,on_destroy:f,after_update:h}=a.$$;d&&d.m(b,c);za(()=>{let b=e.map(U).filter(Ya);f?f.push(...b):b.forEach(U);a.$$.on_mount=[]});h.forEach(za)}function M(a,b){a=a.$$;null!==a.fragment&&(a.on_destroy.forEach(U),a.fragment&&a.fragment.d(b),a.on_destroy=a.fragment=null,a.ctx=[])}function I(a,b,c,d,e,f,h=
[-1]){let k=N;N=a;let m=b.props||{},g=a.$$={fragment:null,ctx:null,props:f,update:v,not_equal:e,bound:Object.create(null),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(k?k.$$.context:[]),callbacks:Object.create(null),dirty:h,skip_bound:!1},l=!1;g.ctx=c?c(a,m,(b,c,...d)=>{d=d.length?d[0]:c;if(g.ctx&&e(g.ctx[b],g.ctx[b]=d)){if(!g.skip_bound&&g.bound[b])g.bound[b](d);l&&(-1===a.$$.dirty[0]&&(ha.push(a),Ca||(Ca=!0,Kb.then(ab)),a.$$.dirty.fill(0)),a.$$.dirty[b/31|0]|=1<<b%
31)}return c}):[];g.update();l=!0;g.before_update.forEach(U);g.fragment=d?d(g.ctx):!1;b.target&&(b.hydrate?(c=Array.from(b.target.childNodes),g.fragment&&g.fragment.l(c),c.forEach(w)):g.fragment&&g.fragment.c(),b.intro&&n(a.$$.fragment),L(a,b.target,b.anchor),ab());N=k}function Lb(a){let b,c,d,e,f;return{c(){b=document.createElement("button");q(b,"aria-label",c=a[3]?a[3]:null);q(b,"class",d=`${a[1]||""} shepherd-button ${a[4]?"shepherd-button-secondary":""}`);b.disabled=a[2];q(b,"tabindex","0")},
m(c,d){c.insertBefore(b,d||null);b.innerHTML=a[5];e||(f=la(b,"click",function(){Ya(a[0])&&a[0].apply(this,arguments)}),e=!0)},p(e,[f]){a=e;f&32&&(b.innerHTML=a[5]);f&8&&c!==(c=a[3]?a[3]:null)&&q(b,"aria-label",c);f&18&&d!==(d=`${a[1]||""} shepherd-button ${a[4]?"shepherd-button-secondary":""}`)&&q(b,"class",d);f&4&&(b.disabled=a[2])},i:v,o:v,d(a){a&&w(b);e=!1;f()}}}function Mb(a,b,c){let {config:d}=b,{step:e}=b,f,h,k,m,g,l;a.$$set=a=>{"config"in a&&c(6,d=a.config);"step"in a&&c(7,e=a.step)};a.$$.update=
()=>{if(a.$$.dirty&192){c(0,f=d.action?d.action.bind(e.tour):null);c(1,h=d.classes);if(d.disabled){var b=d.disabled;b=T(b)?b.call(e):b}else b=!1;c(2,k=b);c(3,m=d.label);c(4,g=d.secondary);c(5,l=d.text)}};return[f,h,k,m,g,l,d,e]}function cb(a,b,c){a=a.slice();a[2]=b[c];return a}function db(a){let b,c,d=a[1],e=[];for(let b=0;b<d.length;b+=1)e[b]=eb(cb(a,d,b));let f=a=>r(e[a],1,1,()=>{e[a]=null});return{c(){for(let a=0;a<e.length;a+=1)e[a].c();b=document.createTextNode("")},m(a,d){for(let b=0;b<e.length;b+=
1)e[b].m(a,d);a.insertBefore(b,d||null);c=!0},p(a,c){if(c&3){d=a[1];let h;for(h=0;h<d.length;h+=1){let f=cb(a,d,h);e[h]?(e[h].p(f,c),n(e[h],1)):(e[h]=eb(f),e[h].c(),n(e[h],1),e[h].m(b.parentNode,b))}O();for(h=d.length;h<e.length;h+=1)f(h);Q()}},i(a){if(!c){for(a=0;a<d.length;a+=1)n(e[a]);c=!0}},o(a){e=e.filter(Boolean);for(a=0;a<e.length;a+=1)r(e[a]);c=!1},d(a){var c=e;for(let b=0;b<c.length;b+=1)c[b]&&c[b].d(a);a&&w(b)}}}function eb(a){let b,c;b=new Nb({props:{config:a[2],step:a[0]}});return{c(){R(b.$$.fragment)},
m(a,e){L(b,a,e);c=!0},p(a,c){let d={};c&2&&(d.config=a[2]);c&1&&(d.step=a[0]);b.$set(d)},i(a){c||(n(b.$$.fragment,a),c=!0)},o(a){r(b.$$.fragment,a);c=!1},d(a){M(b,a)}}}function Ob(a){let b,c,d=a[1]&&db(a);return{c(){b=document.createElement("footer");d&&d.c();q(b,"class","shepherd-footer")},m(a,f){a.insertBefore(b,f||null);d&&d.m(b,null);c=!0},p(a,[c]){a[1]?d?(d.p(a,c),c&2&&n(d,1)):(d=db(a),d.c(),n(d,1),d.m(b,null)):d&&(O(),r(d,1,1,()=>{d=null}),Q())},i(a){c||(n(d),c=!0)},o(a){r(d);c=!1},d(a){a&&
w(b);d&&d.d()}}}function Pb(a,b,c){let {step:d}=b;a.$$set=a=>{"step"in a&&c(0,d=a.step)};let e;a.$$.update=()=>{a.$$.dirty&1&&c(1,e=d.options.buttons)};return[d,e]}function Qb(a){let b,c,d,e,f;return{c(){b=document.createElement("button");c=document.createElement("span");c.textContent="\u00d7";q(c,"aria-hidden","true");q(b,"aria-label",d=a[0].label?a[0].label:"Close Tour");q(b,"class","shepherd-cancel-icon");q(b,"type","button")},m(d,k){d.insertBefore(b,k||null);b.appendChild(c);e||(f=la(b,"click",
a[1]),e=!0)},p(a,[c]){c&1&&d!==(d=a[0].label?a[0].label:"Close Tour")&&q(b,"aria-label",d)},i:v,o:v,d(a){a&&w(b);e=!1;f()}}}function Rb(a,b,c){let {cancelIcon:d}=b,{step:e}=b;a.$$set=a=>{"cancelIcon"in a&&c(0,d=a.cancelIcon);"step"in a&&c(2,e=a.step)};return[d,a=>{a.preventDefault();e.cancel()},e]}function Sb(a){let b;return{c(){b=document.createElement("h3");q(b,"id",a[1]);q(b,"class","shepherd-title")},m(c,d){c.insertBefore(b,d||null);a[3](b)},p(a,[d]){d&2&&q(b,"id",a[1])},i:v,o:v,d(c){c&&w(b);
a[3](null)}}}function Tb(a,b,c){let {labelId:d}=b,{element:e}=b,{title:f}=b;ma().$$.after_update.push(()=>{T(f)&&c(2,f=f());c(0,e.innerHTML=f,e)});a.$$set=a=>{"labelId"in a&&c(1,d=a.labelId);"element"in a&&c(0,e=a.element);"title"in a&&c(2,f=a.title)};return[e,d,f,function(a){W[a?"unshift":"push"](()=>{e=a;c(0,e)})}]}function fb(a){let b,c;b=new Ub({props:{labelId:a[0],title:a[2]}});return{c(){R(b.$$.fragment)},m(a,e){L(b,a,e);c=!0},p(a,c){let d={};c&1&&(d.labelId=a[0]);c&4&&(d.title=a[2]);b.$set(d)},
i(a){c||(n(b.$$.fragment,a),c=!0)},o(a){r(b.$$.fragment,a);c=!1},d(a){M(b,a)}}}function gb(a){let b,c;b=new Vb({props:{cancelIcon:a[3],step:a[1]}});return{c(){R(b.$$.fragment)},m(a,e){L(b,a,e);c=!0},p(a,c){let d={};c&8&&(d.cancelIcon=a[3]);c&2&&(d.step=a[1]);b.$set(d)},i(a){c||(n(b.$$.fragment,a),c=!0)},o(a){r(b.$$.fragment,a);c=!1},d(a){M(b,a)}}}function Wb(a){let b,c,d,e=a[2]&&fb(a),f=a[3]&&a[3].enabled&&gb(a);return{c(){b=document.createElement("header");e&&e.c();c=document.createTextNode(" ");
f&&f.c();q(b,"class","shepherd-header")},m(a,k){a.insertBefore(b,k||null);e&&e.m(b,null);b.appendChild(c);f&&f.m(b,null);d=!0},p(a,[d]){a[2]?e?(e.p(a,d),d&4&&n(e,1)):(e=fb(a),e.c(),n(e,1),e.m(b,c)):e&&(O(),r(e,1,1,()=>{e=null}),Q());a[3]&&a[3].enabled?f?(f.p(a,d),d&8&&n(f,1)):(f=gb(a),f.c(),n(f,1),f.m(b,null)):f&&(O(),r(f,1,1,()=>{f=null}),Q())},i(a){d||(n(e),n(f),d=!0)},o(a){r(e);r(f);d=!1},d(a){a&&w(b);e&&e.d();f&&f.d()}}}function Xb(a,b,c){let {labelId:d}=b,{step:e}=b,f,h;a.$$set=a=>{"labelId"in
a&&c(0,d=a.labelId);"step"in a&&c(1,e=a.step)};a.$$.update=()=>{a.$$.dirty&2&&(c(2,f=e.options.title),c(3,h=e.options.cancelIcon))};return[d,e,f,h]}function Yb(a){let b;return{c(){b=document.createElement("div");q(b,"class","shepherd-text");q(b,"id",a[1])},m(c,d){c.insertBefore(b,d||null);a[3](b)},p(a,[d]){d&2&&q(b,"id",a[1])},i:v,o:v,d(c){c&&w(b);a[3](null)}}}function Zb(a,b,c){let {descriptionId:d}=b,{element:e}=b,{step:f}=b;ma().$$.after_update.push(()=>{let {text:a}=f.options;T(a)&&(a=a.call(f));
a instanceof HTMLElement?e.appendChild(a):c(0,e.innerHTML=a,e)});a.$$set=a=>{"descriptionId"in a&&c(1,d=a.descriptionId);"element"in a&&c(0,e=a.element);"step"in a&&c(2,f=a.step)};return[e,d,f,function(a){W[a?"unshift":"push"](()=>{e=a;c(0,e)})}]}function hb(a){let b,c;b=new $b({props:{labelId:a[1],step:a[2]}});return{c(){R(b.$$.fragment)},m(a,e){L(b,a,e);c=!0},p(a,c){let d={};c&2&&(d.labelId=a[1]);c&4&&(d.step=a[2]);b.$set(d)},i(a){c||(n(b.$$.fragment,a),c=!0)},o(a){r(b.$$.fragment,a);c=!1},d(a){M(b,
a)}}}function ib(a){let b,c;b=new ac({props:{descriptionId:a[0],step:a[2]}});return{c(){R(b.$$.fragment)},m(a,e){L(b,a,e);c=!0},p(a,c){let d={};c&1&&(d.descriptionId=a[0]);c&4&&(d.step=a[2]);b.$set(d)},i(a){c||(n(b.$$.fragment,a),c=!0)},o(a){r(b.$$.fragment,a);c=!1},d(a){M(b,a)}}}function jb(a){let b,c;b=new bc({props:{step:a[2]}});return{c(){R(b.$$.fragment)},m(a,e){L(b,a,e);c=!0},p(a,c){let d={};c&4&&(d.step=a[2]);b.$set(d)},i(a){c||(n(b.$$.fragment,a),c=!0)},o(a){r(b.$$.fragment,a);c=!1},d(a){M(b,
a)}}}function cc(a){let b,c=void 0!==a[2].options.title||a[2].options.cancelIcon&&a[2].options.cancelIcon.enabled,d,e=void 0!==a[2].options.text,f,h=Array.isArray(a[2].options.buttons)&&a[2].options.buttons.length,k,m=c&&hb(a),g=e&&ib(a),l=h&&jb(a);return{c(){b=document.createElement("div");m&&m.c();d=document.createTextNode(" ");g&&g.c();f=document.createTextNode(" ");l&&l.c();q(b,"class","shepherd-content")},m(a,c){a.insertBefore(b,c||null);m&&m.m(b,null);b.appendChild(d);g&&g.m(b,null);b.appendChild(f);
l&&l.m(b,null);k=!0},p(a,[k]){k&4&&(c=void 0!==a[2].options.title||a[2].options.cancelIcon&&a[2].options.cancelIcon.enabled);c?m?(m.p(a,k),k&4&&n(m,1)):(m=hb(a),m.c(),n(m,1),m.m(b,d)):m&&(O(),r(m,1,1,()=>{m=null}),Q());k&4&&(e=void 0!==a[2].options.text);e?g?(g.p(a,k),k&4&&n(g,1)):(g=ib(a),g.c(),n(g,1),g.m(b,f)):g&&(O(),r(g,1,1,()=>{g=null}),Q());k&4&&(h=Array.isArray(a[2].options.buttons)&&a[2].options.buttons.length);h?l?(l.p(a,k),k&4&&n(l,1)):(l=jb(a),l.c(),n(l,1),l.m(b,null)):l&&(O(),r(l,1,1,
()=>{l=null}),Q())},i(a){k||(n(m),n(g),n(l),k=!0)},o(a){r(m);r(g);r(l);k=!1},d(a){a&&w(b);m&&m.d();g&&g.d();l&&l.d()}}}function dc(a,b,c){let {descriptionId:d}=b,{labelId:e}=b,{step:f}=b;a.$$set=a=>{"descriptionId"in a&&c(0,d=a.descriptionId);"labelId"in a&&c(1,e=a.labelId);"step"in a&&c(2,f=a.step)};return[d,e,f]}function kb(a){let b;return{c(){b=document.createElement("div");q(b,"class","shepherd-arrow");q(b,"data-popper-arrow","")},m(a,d){a.insertBefore(b,d||null)},d(a){a&&w(b)}}}function ec(a){let b,
c,d,e,f,h,k,m,g=a[4].options.arrow&&a[4].options.attachTo&&a[4].options.attachTo.element&&a[4].options.attachTo.on&&kb();d=new fc({props:{descriptionId:a[2],labelId:a[3],step:a[4]}});let l=[{"aria-describedby":e=void 0!==a[4].options.text?a[2]:null},{"aria-labelledby":f=a[4].options.title?a[3]:null},a[1],{role:"dialog"},{tabindex:"0"}],p={};for(let a=0;a<l.length;a+=1)p=Jb(p,l[a]);return{c(){b=document.createElement("div");g&&g.c();c=document.createTextNode(" ");R(d.$$.fragment);$a(b,p);V(b,"shepherd-has-cancel-icon",
a[5]);V(b,"shepherd-has-title",a[6]);V(b,"shepherd-element",!0)},m(e,f){e.insertBefore(b,f||null);g&&g.m(b,null);b.appendChild(c);L(d,b,null);a[13](b);h=!0;k||(m=la(b,"keydown",a[7]),k=!0)},p(a,[k]){a[4].options.arrow&&a[4].options.attachTo&&a[4].options.attachTo.element&&a[4].options.attachTo.on?g||(g=kb(),g.c(),g.m(b,c)):g&&(g.d(1),g=null);var m={};k&4&&(m.descriptionId=a[2]);k&8&&(m.labelId=a[3]);k&16&&(m.step=a[4]);d.$set(m);m=b;{k=[(!h||k&20&&e!==(e=void 0!==a[4].options.text?a[2]:null))&&{"aria-describedby":e},
(!h||k&24&&f!==(f=a[4].options.title?a[3]:null))&&{"aria-labelledby":f},k&2&&a[1],{role:"dialog"},{tabindex:"0"}];let b={},c={},d={$$scope:1},g=l.length;for(;g--;){let a=l[g],e=k[g];if(e){for(u in a)u in e||(c[u]=1);for(let a in e)d[a]||(b[a]=e[a],d[a]=1);l[g]=e}else for(let b in a)d[b]=1}for(let a in c)a in b||(b[a]=void 0);var u=b}$a(m,p=u);V(b,"shepherd-has-cancel-icon",a[5]);V(b,"shepherd-has-title",a[6]);V(b,"shepherd-element",!0)},i(a){h||(n(d.$$.fragment,a),h=!0)},o(a){r(d.$$.fragment,a);h=
!1},d(c){c&&w(b);g&&g.d();M(d);a[13](null);k=!1;m()}}}function lb(a){return a.split(" ").filter(a=>!!a.length)}function gc(a,b,c){let {classPrefix:d}=b,{element:e}=b,{descriptionId:f}=b,{firstFocusableElement:h}=b,{focusableElements:k}=b,{labelId:m}=b,{lastFocusableElement:g}=b,{step:l}=b,{dataStepId:p}=b,t,y,A;ma().$$.on_mount.push(()=>{c(1,p={[`data-${d}shepherd-step-id`]:l.id});c(9,k=e.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]'));
c(8,h=k[0]);c(10,g=k[k.length-1])});ma().$$.after_update.push(()=>{if(A!==l.options.classes){var a=A;Z(a)&&(a=lb(a),a.length&&e.classList.remove(...a));a=A=l.options.classes;Z(a)&&(a=lb(a),a.length&&e.classList.add(...a))}});a.$$set=a=>{"classPrefix"in a&&c(11,d=a.classPrefix);"element"in a&&c(0,e=a.element);"descriptionId"in a&&c(2,f=a.descriptionId);"firstFocusableElement"in a&&c(8,h=a.firstFocusableElement);"focusableElements"in a&&c(9,k=a.focusableElements);"labelId"in a&&c(3,m=a.labelId);"lastFocusableElement"in
a&&c(10,g=a.lastFocusableElement);"step"in a&&c(4,l=a.step);"dataStepId"in a&&c(1,p=a.dataStepId)};a.$$.update=()=>{a.$$.dirty&16&&(c(5,t=l.options&&l.options.cancelIcon&&l.options.cancelIcon.enabled),c(6,y=l.options&&l.options.title))};return[e,p,f,m,l,t,y,a=>{const {tour:b}=l;switch(a.keyCode){case 9:if(0===k.length){a.preventDefault();break}if(a.shiftKey){if(document.activeElement===h||document.activeElement.classList.contains("shepherd-element"))a.preventDefault(),g.focus()}else document.activeElement===
g&&(a.preventDefault(),h.focus());break;case 27:b.options.exitOnEsc&&l.cancel();break;case 37:b.options.keyboardNavigation&&b.back();break;case 39:b.options.keyboardNavigation&&b.next()}},h,k,g,d,()=>e,function(a){W[a?"unshift":"push"](()=>{e=a;c(0,e)})}]}function hc(a){a&&({steps:a}=a,a.forEach(a=>{a.options&&!1===a.options.canClickTarget&&a.options.attachTo&&a.target instanceof HTMLElement&&a.target.classList.remove("shepherd-target-click-disabled")}))}function ic({width:a,height:b,x:c=0,y:d=0,
r:e=0}){let {innerWidth:f,innerHeight:h}=window;return`M${f},${h}\
H0\
V0\
H${f}\
V${h}\
Z\
M${c+e},${d}\
a${e},${e},0,0,0-${e},${e}\
V${b+d-e}\
a${e},${e},0,0,0,${e},${e}\
H${a+c-e}\
a${e},${e},0,0,0,${e}-${e}\
V${d+e}\
a${e},${e},0,0,0-${e}-${e}\
Z`}function jc(a){let b,c,d,e,f;return{c(){b=Za("svg");c=Za("path");q(c,"d",a[2]);q(b,"class",d=`${a[1]?"shepherd-modal-is-visible":""} shepherd-modal-overlay-container`)},m(d,k){d.insertBefore(b,k||null);b.appendChild(c);a[11](b);e||(f=la(b,"touchmove",a[3]),e=!0)},p(a,[e]){e&4&&q(c,"d",a[2]);e&2&&d!==(d=`${a[1]?"shepherd-modal-is-visible":""} shepherd-modal-overlay-container`)&&q(b,"class",d)},i:v,o:v,d(c){c&&w(b);a[11](null);e=!1;f()}}}function mb(a){if(!a)return null;let b=a instanceof HTMLElement&&
window.getComputedStyle(a).overflowY;return"hidden"!==b&&"visible"!==b&&a.scrollHeight>=a.clientHeight?a:mb(a.parentElement)}function kc(a,b,c){function d(){c(4,l={width:0,height:0,x:0,y:0,r:0})}function e(){c(1,p=!1);k()}function f(a,b,d=0,e=0){if(a.getBoundingClientRect){var f=a.getBoundingClientRect();var g=f.y||f.top;f=f.bottom||g+f.height;if(b){var u=b.getBoundingClientRect();b=u.y||u.top;u=u.bottom||b+u.height;g=Math.max(g,b);f=Math.min(f,u)}g={y:g,height:Math.max(f-g,0)};let {y:h,height:k}=
g,{x:m,width:y,left:p}=a.getBoundingClientRect();c(4,l={width:y+2*d,height:k+2*d,x:(m||p)-d,y:h-d,r:e})}}function h(){c(1,p=!0)}function k(){t&&(cancelAnimationFrame(t),t=void 0);window.removeEventListener("touchmove",A,{passive:!1})}function m(a){let {modalOverlayOpeningPadding:b,modalOverlayOpeningRadius:c}=a.options;if(a.target){let d=mb(a.target),e=()=>{t=void 0;f(a.target,d,b,c);t=requestAnimationFrame(e)};e();window.addEventListener("touchmove",A,{passive:!1})}else d()}let {element:g}=b,{openingProperties:l}=
b;ya();let p=!1,t=void 0,y;d();let A=a=>{a.preventDefault()};a.$$set=a=>{"element"in a&&c(0,g=a.element);"openingProperties"in a&&c(4,l=a.openingProperties)};a.$$.update=()=>{a.$$.dirty&16&&c(2,y=ic(l))};return[g,p,y,a=>{a.stopPropagation()},l,()=>g,d,e,f,function(a){k();a.tour.options.useModalOverlay?(m(a),h()):e()},h,function(a){W[a?"unshift":"push"](()=>{g=a;c(0,g)})}]}var qb=function(a){var b;if(b=!!a&&"object"===typeof a)b=Object.prototype.toString.call(a),b=!("[object RegExp]"===b||"[object Date]"===
b||a.$$typeof===lc);return b},lc="function"===typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;S.all=function(a,b){if(!Array.isArray(a))throw Error("first argument should be an array");return a.reduce(function(a,d){return S(a,d,b)},{})};var mc=S;class Da{on(a,b,c,d=!1){void 0===this.bindings&&(this.bindings={});void 0===this.bindings[a]&&(this.bindings[a]=[]);this.bindings[a].push({handler:b,ctx:c,once:d});return this}once(a,b,c){return this.on(a,b,c,!0)}off(a,b){if(void 0===this.bindings||
void 0===this.bindings[a])return this;void 0===b?delete this.bindings[a]:this.bindings[a].forEach((c,d)=>{c.handler===b&&this.bindings[a].splice(d,1)});return this}trigger(a,...b){void 0!==this.bindings&&this.bindings[a]&&this.bindings[a].forEach((c,d)=>{let {ctx:e,handler:f,once:h}=c;f.apply(e||this,b);h&&this.bindings[a].splice(d,1)});return this}}var fa=["top","bottom","right","left"],Sa=fa.reduce(function(a,b){return a.concat([b+"-start",b+"-end"])},[]),Ra=[].concat(fa,["auto"]).reduce(function(a,
b){return a.concat([b,b+"-start",b+"-end"])},[]),Db="beforeRead read afterRead beforeMain main afterMain beforeWrite write afterWrite".split(" "),tb={top:"auto",right:"auto",bottom:"auto",left:"auto"},pa={passive:!0},ub={left:"right",right:"left",bottom:"top",top:"bottom"},vb={start:"end",end:"start"},nb={placement:"bottom",modifiers:[],strategy:"absolute"},nc=function(a){void 0===a&&(a={});var b=a.defaultModifiers,c=void 0===b?[]:b;a=a.defaultOptions;var d=void 0===a?nb:a;return function(a,b,h){function e(){g.orderedModifiers.forEach(function(a){var b=
a.name,c=a.options;c=void 0===c?{}:c;a=a.effect;"function"===typeof a&&(b=a({state:g,name:b,instance:t,options:c}),l.push(b||function(){}))})}function f(){l.forEach(function(a){return a()});l=[]}void 0===h&&(h=d);var g={placement:"bottom",orderedModifiers:[],options:Object.assign(Object.assign({},nb),d),modifiersData:{},elements:{reference:a,popper:b},attributes:{},styles:{}},l=[],p=!1,t={state:g,setOptions:function(h){f();g.options=Object.assign(Object.assign(Object.assign({},d),g.options),h);g.scrollParents=
{reference:aa(a)?da(a):a.contextElement?da(a.contextElement):[],popper:da(b)};h=Cb(Fb([].concat(c,g.options.modifiers)));g.orderedModifiers=h.filter(function(a){return a.enabled});e();return t.update()},forceUpdate:function(){if(!p){var a=g.elements,b=a.reference;a=a.popper;if(Va(b,a))for(g.rects={reference:Ab(b,ba(a),"fixed"===g.options.strategy),popper:qa(a)},g.reset=!1,g.placement=g.options.placement,g.orderedModifiers.forEach(function(a){return g.modifiersData[a.name]=Object.assign({},a.data)}),
b=0;b<g.orderedModifiers.length;b++)if(!0===g.reset)g.reset=!1,b=-1;else{var c=g.orderedModifiers[b];a=c.fn;var d=c.options;d=void 0===d?{}:d;c=c.name;"function"===typeof a&&(g=a({state:g,options:d,name:c,instance:t})||g)}}},update:Eb(function(){return new Promise(function(a){t.forceUpdate();a(g)})}),destroy:function(){f();p=!0}};if(!Va(a,b))return t;t.setOptions(h).then(function(a){if(!p&&h.onFirstUpdate)h.onFirstUpdate(a)});return t}}({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",
fn:function(){},effect:function(a){var b=a.state,c=a.instance;a=a.options;var d=a.scroll,e=void 0===d?!0:d;a=a.resize;var f=void 0===a?!0:a,h=z(b.elements.popper),k=[].concat(b.scrollParents.reference,b.scrollParents.popper);e&&k.forEach(function(a){a.addEventListener("scroll",c.update,pa)});f&&h.addEventListener("resize",c.update,pa);return function(){e&&k.forEach(function(a){a.removeEventListener("scroll",c.update,pa)});f&&h.removeEventListener("resize",c.update,pa)}},data:{}},{name:"popperOffsets",
enabled:!0,phase:"read",fn:function(a){var b=a.state;b.modifiersData[a.name]=Qa({reference:b.rects.reference,element:b.rects.popper,strategy:"absolute",placement:b.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(a){var b=a.state,c=a.options;a=c.gpuAcceleration;a=void 0===a?!0:a;c=c.adaptive;c=void 0===c?!0:c;a={placement:C(b.placement),popper:b.elements.popper,popperRect:b.rects.popper,gpuAcceleration:a};null!=b.modifiersData.popperOffsets&&(b.styles.popper=
Object.assign(Object.assign({},b.styles.popper),Ma(Object.assign(Object.assign({},a),{},{offsets:b.modifiersData.popperOffsets,position:b.options.strategy,adaptive:c}))));null!=b.modifiersData.arrow&&(b.styles.arrow=Object.assign(Object.assign({},b.styles.arrow),Ma(Object.assign(Object.assign({},a),{},{offsets:b.modifiersData.arrow,position:"absolute",adaptive:!1}))));b.attributes.popper=Object.assign(Object.assign({},b.attributes.popper),{},{"data-popper-placement":b.placement})},data:{}},{name:"applyStyles",
enabled:!0,phase:"write",fn:function(a){var b=a.state;Object.keys(b.elements).forEach(function(a){var c=b.styles[a]||{},e=b.attributes[a]||{},f=b.elements[a];B(f)&&x(f)&&(Object.assign(f.style,c),Object.keys(e).forEach(function(a){var b=e[a];!1===b?f.removeAttribute(a):f.setAttribute(a,!0===b?"":b)}))})},effect:function(a){var b=a.state,c={popper:{position:b.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(b.elements.popper.style,c.popper);b.elements.arrow&&
Object.assign(b.elements.arrow.style,c.arrow);return function(){Object.keys(b.elements).forEach(function(a){var d=b.elements[a],f=b.attributes[a]||{};a=Object.keys(b.styles.hasOwnProperty(a)?b.styles[a]:c[a]).reduce(function(a,b){a[b]="";return a},{});B(d)&&x(d)&&(Object.assign(d.style,a),Object.keys(f).forEach(function(a){d.removeAttribute(a)}))})}},requires:["computeStyles"]},{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(a){var b=a.state,c=a.name;a=a.options.offset;
var d=void 0===a?[0,0]:a;a=Ra.reduce(function(a,c){var e=b.rects;var f=C(c);var h=0<=["left","top"].indexOf(f)?-1:1,k="function"===typeof d?d(Object.assign(Object.assign({},e),{},{placement:c})):d;e=k[0];k=k[1];e=e||0;k=(k||0)*h;f=0<=["left","right"].indexOf(f)?{x:k,y:e}:{x:e,y:k};a[c]=f;return a},{});var e=a[b.placement],f=e.x;e=e.y;null!=b.modifiersData.popperOffsets&&(b.modifiersData.popperOffsets.x+=f,b.modifiersData.popperOffsets.y+=e);b.modifiersData[c]=a}},{name:"flip",enabled:!0,phase:"main",
fn:function(a){var b=a.state,c=a.options;a=a.name;if(!b.modifiersData[a]._skip){var d=c.mainAxis;d=void 0===d?!0:d;var e=c.altAxis;e=void 0===e?!0:e;var f=c.fallbackPlacements,h=c.padding,k=c.boundary,m=c.rootBoundary,g=c.altBoundary,l=c.flipVariations,p=void 0===l?!0:l,t=c.allowedAutoPlacements;c=b.options.placement;l=C(c);f=f||(l!==c&&p?zb(c):[ka(c)]);var y=[c].concat(f).reduce(function(a,c){return a.concat("auto"===C(c)?yb(b,{placement:c,boundary:k,rootBoundary:m,padding:h,flipVariations:p,allowedAutoPlacements:t}):
c)},[]);c=b.rects.reference;f=b.rects.popper;var n=new Map;l=!0;for(var u=y[0],J=0;J<y.length;J++){var ia=y[J],q=C(ia),r="start"===ia.split("-")[1],D=0<=["top","bottom"].indexOf(q),v=D?"width":"height",w=ea(b,{placement:ia,boundary:k,rootBoundary:m,altBoundary:g,padding:h});r=D?r?"right":"left":r?"bottom":"top";c[v]>f[v]&&(r=ka(r));v=ka(r);D=[];d&&D.push(0>=w[q]);e&&D.push(0>=w[r],0>=w[v]);if(D.every(function(a){return a})){u=ia;l=!1;break}n.set(ia,D)}if(l)for(d=function(a){var b=y.find(function(b){if(b=
n.get(b))return b.slice(0,a).every(function(a){return a})});if(b)return u=b,"break"},e=p?3:1;0<e&&"break"!==d(e);e--);b.placement!==u&&(b.modifiersData[a]._skip=!0,b.placement=u,b.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(a){var b=a.state,c=a.options;a=a.name;var d=c.mainAxis,e=void 0===d?!0:d;d=c.altAxis;d=void 0===d?!1:d;var f=c.tether;f=void 0===f?!0:f;var h=c.tetherOffset,k=void 0===h?0:h;c=ea(b,{boundary:c.boundary,rootBoundary:c.rootBoundary,
padding:c.padding,altBoundary:c.altBoundary});h=C(b.placement);var m=b.placement.split("-")[1],g=!m,l=ra(h);h="x"===l?"y":"x";var p=b.modifiersData.popperOffsets,t=b.rects.reference,n=b.rects.popper,q="function"===typeof k?k(Object.assign(Object.assign({},b.rects),{},{placement:b.placement})):k;k={x:0,y:0};if(p){if(e){var u="y"===l?"top":"left",J="y"===l?"bottom":"right",r="y"===l?"height":"width";e=p[l];var v=p[l]+c[u],w=p[l]-c[J],D=f?-n[r]/2:0,x="start"===m?t[r]:n[r];m="start"===m?-n[r]:-t[r];n=
b.elements.arrow;n=f&&n?qa(n):{width:0,height:0};var z=b.modifiersData["arrow#persistent"]?b.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0};u=z[u];J=z[J];n=Math.max(0,Math.min(t[r],n[r]));x=g?t[r]/2-D-n-u-q:x-n-u-q;g=g?-t[r]/2+D+n+J+q:m+n+J+q;q=b.elements.arrow&&ba(b.elements.arrow);t=b.modifiersData.offset?b.modifiersData.offset[b.placement][l]:0;q=p[l]+x-t-(q?"y"===l?q.clientTop||0:q.clientLeft||0:0);g=p[l]+g-t;f=Math.max(f?Math.min(v,q):v,Math.min(e,f?Math.max(w,g):w));
p[l]=f;k[l]=f-e}d&&(d=p[h],f=Math.max(d+c["x"===l?"top":"left"],Math.min(d,d-c["x"===l?"bottom":"right"])),p[h]=f,k[h]=f-d);b.modifiersData[a]=k}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(a){var b,c=a.state;a=a.name;var d=c.elements.arrow,e=c.modifiersData.popperOffsets,f=C(c.placement),h=ra(f);f=0<=["left","right"].indexOf(f)?"height":"width";if(d&&e){var k=c.modifiersData[a+"#persistent"].padding,m=qa(d),g="y"===h?"top":"left",l="y"===h?"bottom":"right",p=c.rects.reference[f]+
c.rects.reference[h]-e[h]-c.rects.popper[f];e=e[h]-c.rects.reference[h];d=(d=ba(d))?"y"===h?d.clientHeight||0:d.clientWidth||0:0;p=d/2-m[f]/2+(p/2-e/2);f=Math.max(k[g],Math.min(p,d-m[f]-k[l]));c.modifiersData[a]=(b={},b[h]=f,b.centerOffset=f-p,b)}},effect:function(a){var b=a.state,c=a.options;a=a.name;var d=c.element;d=void 0===d?"[data-popper-arrow]":d;c=c.padding;c=void 0===c?0:c;if(null!=d){if("string"===typeof d&&(d=b.elements.popper.querySelector(d),!d))return;Ia(b.elements.popper,d)&&(b.elements.arrow=
d,b.modifiersData[a+"#persistent"]={padding:Ka("number"!==typeof c?c:La(c,fa))})}},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(a){var b=a.state;a=a.name;var c=b.rects.reference,d=b.rects.popper,e=b.modifiersData.preventOverflow,f=ea(b,{elementContext:"reference"}),h=ea(b,{altBoundary:!0});c=Ta(f,c);d=Ta(h,d,e);e=Ua(c);h=Ua(d);b.modifiersData[a]={referenceClippingOffsets:c,popperEscapeOffsets:d,
isReferenceHidden:e,hasPopperEscaped:h};b.attributes.popper=Object.assign(Object.assign({},b.attributes.popper),{},{"data-popper-reference-hidden":e,"data-popper-escaped":h})}}]});let N,ha=[],W=[],na=[],bb=[],Kb=Promise.resolve(),Ca=!1,Aa=!1,Ba=new Set,oa=new Set,P;class K{$destroy(){M(this,1);this.$destroy=v}$on(a,b){let c=this.$$.callbacks[a]||(this.$$.callbacks[a]=[]);c.push(b);return()=>{let a=c.indexOf(b);-1!==a&&c.splice(a,1)}}$set(a){this.$$set&&0!==Object.keys(a).length&&(this.$$.skip_bound=
!0,this.$$set(a),this.$$.skip_bound=!1)}}class Nb extends K{constructor(a){super();I(this,a,Mb,Lb,H,{config:6,step:7})}}class bc extends K{constructor(a){super();I(this,a,Pb,Ob,H,{step:0})}}class Vb extends K{constructor(a){super();I(this,a,Rb,Qb,H,{cancelIcon:0,step:2})}}class Ub extends K{constructor(a){super();I(this,a,Tb,Sb,H,{labelId:1,element:0,title:2})}}class $b extends K{constructor(a){super();I(this,a,Xb,Wb,H,{labelId:0,step:1})}}class ac extends K{constructor(a){super();I(this,a,Zb,Yb,
H,{descriptionId:1,element:0,step:2})}}class fc extends K{constructor(a){super();I(this,a,dc,cc,H,{descriptionId:0,labelId:1,step:2})}}class oc extends K{constructor(a){super();I(this,a,gc,ec,H,{classPrefix:11,element:0,descriptionId:2,firstFocusableElement:8,focusableElements:9,labelId:3,lastFocusableElement:10,step:4,dataStepId:1,getElement:12})}get getElement(){return this.$$.ctx[12]}}(function(a,b){return b={exports:{}},a(b,b.exports),b.exports})(function(a,b){(function(){a.exports={polyfill:function(){function a(a,
b){this.scrollLeft=a;this.scrollTop=b}function b(a){if(null===a||"object"!==typeof a||void 0===a.behavior||"auto"===a.behavior||"instant"===a.behavior)return!0;if("object"===typeof a&&"smooth"===a.behavior)return!1;throw new TypeError("behavior member of ScrollOptions "+a.behavior+" is not a valid value for enumeration ScrollBehavior.");}function e(a,b){if("Y"===b)return a.clientHeight+r<a.scrollHeight;if("X"===b)return a.clientWidth+r<a.scrollWidth}function f(a,b){a=g.getComputedStyle(a,null)["overflow"+
b];return"auto"===a||"scroll"===a}function h(a){var b=e(a,"Y")&&f(a,"Y");a=e(a,"X")&&f(a,"X");return b||a}function k(a){var b=(q()-a.startTime)/468;var c=.5*(1-Math.cos(Math.PI*(1<b?1:b)));b=a.startX+(a.x-a.startX)*c;c=a.startY+(a.y-a.startY)*c;a.method.call(a.scrollable,b,c);b===a.x&&c===a.y||g.requestAnimationFrame(k.bind(g,a))}function m(b,c,d){var e=q();if(b===l.body){var f=g;var h=g.scrollX||g.pageXOffset;b=g.scrollY||g.pageYOffset;var u=n.scroll}else f=b,h=b.scrollLeft,b=b.scrollTop,u=a;k({scrollable:f,
method:u,startTime:e,startX:h,startY:b,x:c,y:d})}var g=window,l=document;if(!("scrollBehavior"in l.documentElement.style&&!0!==g.__forceSmoothScrollPolyfill__)){var p=g.HTMLElement||g.Element,n={scroll:g.scroll||g.scrollTo,scrollBy:g.scrollBy,elementScroll:p.prototype.scroll||a,scrollIntoView:p.prototype.scrollIntoView},q=g.performance&&g.performance.now?g.performance.now.bind(g.performance):Date.now,r=/MSIE |Trident\/|Edge\//.test(g.navigator.userAgent)?1:0;g.scroll=g.scrollTo=function(a,c){void 0!==
a&&(!0===b(a)?n.scroll.call(g,void 0!==a.left?a.left:"object"!==typeof a?a:g.scrollX||g.pageXOffset,void 0!==a.top?a.top:void 0!==c?c:g.scrollY||g.pageYOffset):m.call(g,l.body,void 0!==a.left?~~a.left:g.scrollX||g.pageXOffset,void 0!==a.top?~~a.top:g.scrollY||g.pageYOffset))};g.scrollBy=function(a,c){void 0!==a&&(b(a)?n.scrollBy.call(g,void 0!==a.left?a.left:"object"!==typeof a?a:0,void 0!==a.top?a.top:void 0!==c?c:0):m.call(g,l.body,~~a.left+(g.scrollX||g.pageXOffset),~~a.top+(g.scrollY||g.pageYOffset)))};
p.prototype.scroll=p.prototype.scrollTo=function(a,c){if(void 0!==a)if(!0===b(a)){if("number"===typeof a&&void 0===c)throw new SyntaxError("Value could not be converted");n.elementScroll.call(this,void 0!==a.left?~~a.left:"object"!==typeof a?~~a:this.scrollLeft,void 0!==a.top?~~a.top:void 0!==c?~~c:this.scrollTop)}else c=a.left,a=a.top,m.call(this,this,"undefined"===typeof c?this.scrollLeft:~~c,"undefined"===typeof a?this.scrollTop:~~a)};p.prototype.scrollBy=function(a,c){void 0!==a&&(!0===b(a)?n.elementScroll.call(this,
void 0!==a.left?~~a.left+this.scrollLeft:~~a+this.scrollLeft,void 0!==a.top?~~a.top+this.scrollTop:~~c+this.scrollTop):this.scroll({left:~~a.left+this.scrollLeft,top:~~a.top+this.scrollTop,behavior:a.behavior}))};p.prototype.scrollIntoView=function(a){if(!0===b(a))n.scrollIntoView.call(this,void 0===a?!0:a);else{for(a=this;a!==l.body&&!1===h(a);)a=a.parentNode||a.host;var c=a.getBoundingClientRect(),d=this.getBoundingClientRect();a!==l.body?(m.call(this,a,a.scrollLeft+d.left-c.left,a.scrollTop+d.top-
c.top),"fixed"!==g.getComputedStyle(a).position&&g.scrollBy({left:c.left,top:c.top,behavior:"smooth"})):g.scrollBy({left:d.left,top:d.top,behavior:"smooth"})}}}}}})()}).polyfill();class Ea extends Da{constructor(a,b={}){super(a,b);this.tour=a;this.classPrefix=this.tour.options?Wa(this.tour.options.classPrefix):"";this.styles=a.styles;Ha(this);this._setOptions(b);return this}cancel(){this.tour.cancel();this.trigger("cancel")}complete(){this.tour.complete();this.trigger("complete")}destroy(){this.tooltip&&
(this.tooltip.destroy(),this.tooltip=null);this.el instanceof HTMLElement&&this.el.parentNode&&(this.el.parentNode.removeChild(this.el),this.el=null);this._updateStepTargetOnHide();this.trigger("destroy")}getTour(){return this.tour}hide(){this.tour.modal.hide();this.trigger("before-hide");this.el&&(this.el.hidden=!0);this._updateStepTargetOnHide();this.trigger("hide")}isCentered(){let a=xa(this);return!a.element||!a.on}isOpen(){return!(!this.el||this.el.hidden)}show(){if(T(this.options.beforeShowPromise)){let a=
this.options.beforeShowPromise();if(void 0!==a)return a.then(()=>this._show())}this._show()}updateStepOptions(a){Object.assign(this.options,a);this.shepherdElementComponent&&this.shepherdElementComponent.$set({step:this})}getElement(){return this.el}getTarget(){return this.target}_createTooltipContent(){this.shepherdElementComponent=new oc({target:this.tour.options.stepsContainer||document.body,props:{classPrefix:this.classPrefix,descriptionId:`${this.id}-description`,labelId:`${this.id}-label`,step:this,
styles:this.styles}});return this.shepherdElementComponent.getElement()}_scrollTo(a){let {element:b}=xa(this);T(this.options.scrollToHandler)?this.options.scrollToHandler(b):b instanceof Element&&"function"===typeof b.scrollIntoView&&b.scrollIntoView(a)}_getClassOptions(a){var b=this.tour&&this.tour.options&&this.tour.options.defaultStepOptions;b=b&&b.classes?b.classes:"";a=[...(a.classes?a.classes:"").split(" "),...b.split(" ")];a=new Set(a);return Array.from(a).join(" ").trim()}_setOptions(a={}){let b=
this.tour&&this.tour.options&&this.tour.options.defaultStepOptions;b=mc({},b||{});this.options=Object.assign({arrow:!0},b,a);let {when:c}=this.options;this.options.classes=this._getClassOptions(a);this.destroy();this.id=this.options.id||`step-${ya()}`;c&&Object.keys(c).forEach(a=>{this.on(a,c[a],this)})}_setupElements(){void 0!==this.el&&this.destroy();this.el=this._createTooltipContent();this.options.advanceOn&&sb(this);{this.tooltip&&this.tooltip.destroy();let a=xa(this),b=a.element,c=Ib(a,this);
this.isCentered()&&(b=document.body,this.shepherdElementComponent.getElement().classList.add("shepherd-centered"));this.tooltip=nc(b,this.el,c);this.target=a.element}}_show(){this.trigger("before-show");this._setupElements();this.tour.modal||this.tour._setupModal();this.tour.modal.setupForStep(this);this._styleTargetElementForStep(this);this.el.hidden=!1;this.options.scrollTo&&setTimeout(()=>{this._scrollTo(this.options.scrollTo)});this.el.hidden=!1;let a=this.shepherdElementComponent.getElement(),
b=this.target||document.body;b.classList.add(`${this.classPrefix}shepherd-enabled`);b.classList.add(`${this.classPrefix}shepherd-target`);a.classList.add("shepherd-enabled");this.trigger("show")}_styleTargetElementForStep(a){let b=a.target;b&&(a.options.highlightClass&&b.classList.add(a.options.highlightClass),!1===a.options.canClickTarget&&b.classList.add("shepherd-target-click-disabled"))}_updateStepTargetOnHide(){let a=this.target||document.body;this.options.highlightClass&&a.classList.remove(this.options.highlightClass);
a.classList.remove(`${this.classPrefix}shepherd-enabled`,`${this.classPrefix}shepherd-target`)}}class pc extends K{constructor(a){super();I(this,a,kc,jc,H,{element:0,openingProperties:4,getElement:5,closeModalOpening:6,hide:7,positionModalOpening:8,setupForStep:9,show:10})}get getElement(){return this.$$.ctx[5]}get closeModalOpening(){return this.$$.ctx[6]}get hide(){return this.$$.ctx[7]}get positionModalOpening(){return this.$$.ctx[8]}get setupForStep(){return this.$$.ctx[9]}get show(){return this.$$.ctx[10]}}
let X=new Da;class qc extends Da{constructor(a={}){super(a);Ha(this);this.options=Object.assign({},{exitOnEsc:!0,keyboardNavigation:!0},a);this.classPrefix=Wa(this.options.classPrefix);this.steps=[];this.addSteps(this.options.steps);"active cancel complete inactive show start".split(" ").map(a=>{(a=>{this.on(a,b=>{b=b||{};b.tour=this;X.trigger(a,b)})})(a)});this._setTourID();return this}addStep(a,b){a instanceof Ea?a.tour=this:a=new Ea(this,a);void 0!==b?this.steps.splice(b,0,a):this.steps.push(a);
return a}addSteps(a){Array.isArray(a)&&a.forEach(a=>{this.addStep(a)});return this}back(){let a=this.steps.indexOf(this.currentStep);this.show(a-1,!1)}cancel(){this.options.confirmCancel?window.confirm(this.options.confirmCancelMessage||"Are you sure you want to stop the tour?")&&this._done("cancel"):this._done("cancel")}complete(){this._done("complete")}getById(a){return this.steps.find(b=>b.id===a)}getCurrentStep(){return this.currentStep}hide(){let a=this.getCurrentStep();if(a)return a.hide()}isActive(){return X.activeTour===
this}next(){let a=this.steps.indexOf(this.currentStep);a===this.steps.length-1?this.complete():this.show(a+1,!0)}removeStep(a){let b=this.getCurrentStep();this.steps.some((b,d)=>{if(b.id===a)return b.isOpen()&&b.hide(),b.destroy(),this.steps.splice(d,1),!0});b&&b.id===a&&(this.currentStep=void 0,this.steps.length?this.show(0):this.cancel())}show(a=0,b=!0){if(a=Z(a)?this.getById(a):this.steps[a])this._updateStateBeforeShow(),T(a.options.showOn)&&!a.options.showOn()?this._skipStep(a,b):(this.trigger("show",
{step:a,previous:this.currentStep}),this.currentStep=a,a.show())}start(){this.trigger("start");this.focusedElBeforeOpen=document.activeElement;this.currentStep=null;this._setupModal();this._setupActiveTour();this.next()}_done(a){let b=this.steps.indexOf(this.currentStep);Array.isArray(this.steps)&&this.steps.forEach(a=>a.destroy());hc(this);this.trigger(a,{index:b});X.activeTour=null;this.trigger("inactive",{tour:this});this.modal&&this.modal.hide();"cancel"!==a&&"complete"!==a||!this.modal||(a=document.querySelector(".shepherd-modal-overlay-container"))&&
a.remove();this.focusedElBeforeOpen instanceof HTMLElement&&this.focusedElBeforeOpen.focus()}_setupActiveTour(){this.trigger("active",{tour:this});X.activeTour=this}_setupModal(){this.modal=new pc({target:this.options.modalContainer||document.body,props:{classPrefix:this.classPrefix,styles:this.styles}})}_skipStep(a,b){a=this.steps.indexOf(a);this.show(b?a+1:a-1,b)}_updateStateBeforeShow(){this.currentStep&&this.currentStep.hide();this.isActive()||this._setupActiveTour()}_setTourID(){this.id=`${this.options.tourName||
"tour"}--${ya()}`}}Object.assign(X,{Tour:qc,Step:Ea});return X})
//# sourceMappingURL=shepherd.min.js.map
</script>
<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.5/dist/cdn.min.js"></script>
<style>
    :root { color-scheme: dark; }
    html, body { height: 100%; margin: 0; color: #d1d5db; font-family: 'Segoe UI', system-ui, -apple-system, Roboto, 'Helvetica Neue', Arial, sans-serif; background: transparent; }
    #bgImg{ position: fixed; inset: 0; width: 100%; height: 100%; object-fit: cover; filter: blur(12px) brightness(0.65); transform: scale(1.06); z-index: -2; backface-visibility: hidden; will-change: transform; }
    #bgOverlay{ position: fixed; inset: 0; z-index:-1; background: rgba(0,0,0,0.35); }
    #network { position: fixed; inset: 0; background: transparent; border: none; }
    .glass { background: rgba(31,41,55,0.45); border: 1px solid rgba(255,255,255,0.12); box-shadow: 0 12px 30px rgba(0,0,0,0.35); backdrop-filter: blur(18px); -webkit-backdrop-filter: blur(18px); }
    input { color: #e5e7eb; background-color: rgba(55,65,81,0.55); border: 1px solid rgba(255,255,255,0.12); outline: none; }
    input::placeholder { color: #9ca3af; }
    .ac-panel { background: rgba(31,41,55,0.9); border: 1px solid rgba(255,255,255,0.14); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); box-shadow: 0 14px 28px rgba(0,0,0,0.5); }
    .ac-item { cursor: pointer; }
    .ac-item:hover { background: rgba(255,255,255,0.08); }
    .dropdown-btn { cursor: pointer; }
    .dropdown-panel { background: rgba(31,41,55,0.65); border: 1px solid rgba(255,255,255,0.14); box-shadow: 0 16px 40px rgba(0,0,0,0.45); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); }
    .dropdown-item { cursor: pointer; }
    .dropdown-item:hover { background: rgba(255,255,255,0.06); }
    .modal-bg { background: rgba(0,0,0,0.75); backdrop-filter: blur(4px); }
    .modal-content { width: 92vw; max-width: 780px; max-height: 85vh; overflow-y: auto; background: #0f172a; color: #e5e7eb; border-radius: 18px; padding: 0; box-shadow: 0 12px 24px rgba(0,0,0,0.45); position: relative; border: 1px solid rgba(255,255,255,0.08); }
    .modal-header { display: grid; grid-template-columns: 120px 1fr; gap: 16px; padding: 16px; border-bottom: 1px solid rgba(255,255,255,0.06); background: radial-gradient(1200px 400px at -20% -40%, rgba(239,68,68,0.08), transparent); }
    .poster { width: 120px; height: 160px; border-radius: 10px; object-fit: cover; background: #111827; border: 1px solid rgba(255,255,255,0.08); }
    .modal-body { padding: 16px; }
    .chip { display: inline-flex; align-items: center; gap: 6px; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.10); padding: 4px 10px; border-radius: 999px; font-size: 12px; }
    .meta-grid { display: grid; grid-template-columns: 1fr; gap: 12px; margin-top: 10px; }
    .meta-item { background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.06); padding: 10px 12px; border-radius: 12px; }
    .section-title { font-size: 0.9rem; opacity: 0.85; margin-bottom: 6px; }
    .close-btn { position: absolute; top: 12px; right: 12px; width: 36px; height: 36px; border-radius: 999px; display: grid; place-items: center; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1); cursor: pointer; }
    .close-btn:hover { background: rgba(239,68,68,0.15); border-color: rgba(239,68,68,0.5); }
    #legendWrap { position: fixed; left: 16px; bottom: 16px; z-index: 40; }
    #legendToggle { margin-bottom: 8px; background: rgba(31,41,55,0.55); border: 1px solid rgba(255,255,255,0.14); backdrop-filter: blur(14px); -webkit-backdrop-filter: blur(14px); }
    #legend { background: rgba(31,41,55,0.45); border: 1px solid rgba(255,255,255,0.12); box-shadow: 0 8px 18px rgba(0,0,0,0.35); backdrop-filter: blur(14px); -webkit-backdrop-filter: blur(14px); border-radius: 12px; padding: 12px 16px; max-width: 320px; max-height: 260px; overflow-y: auto; font-size: 0.85rem; }
    @media (max-width: 640px) { #legend { font-size: 0.72rem; max-width: 220px; padding: 8px 10px; } }
    .share-bar { position: absolute; top: 8px; left: 12px; right: 56px; display:flex; align-items:center; gap:8px; opacity:.95; }
    .share-btn { display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:10px; background: rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.14); font-size:12px; }
    .share-btn:hover { background: rgba(255,255,255,0.1); }
    .no-scrollbar::-webkit-scrollbar{ display:none; }
    .no-scrollbar{ -ms-overflow-style:none; scrollbar-width:none; }
  </style>

<style>
  #network {
    position: fixed;
    inset: 0;
    width: 100%;
    height: 100%;
    background: transparent;
    border: none;
    z-index: 0;
  }
</style>


<!-- Shepherd.js CSS ve JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/shepherd.js/dist/css/shepherd.css"/>
<script src="https://cdn.jsdelivr.net/npm/shepherd.js@8.4.1/dist/js/shepherd.min.js"></script>


<style>
  

  

  

  

  

  .shepherd-cancel-icon {
    color: #fff !important;
  }
</style>


<style>
  

  

  

  

  

  .shepherd-cancel-icon {
    color: #fff !important;
  }
</style>


<style>
  .shepherd-element {
    background: rgba(255, 255, 255, 0.08) !important;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-radius: 1rem;
    border: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
    color: white;
    padding: 1rem;
    max-width: 360px;
  }

  .shepherd-text,
  .shepherd-title,
  .shepherd-button {
    color: white !important;
  }

  .shepherd-header {
    background: transparent !important;
    border-bottom: none !important;
  }

  .shepherd-button {
    background-color: #2563eb;
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    font-size: 0.875rem;
    border: none;
    margin-left: 0.5rem;
    cursor: pointer;
    transition: background-color 0.2s ease-in-out;
  }

  .shepherd-button:hover {
    background-color: #1d4ed8;
  }

  .shepherd-cancel-icon {
    color: white !important;
  }
</style>

</head>



<body :class="{ 'overflow-hidden': modalOpen }" class="dark">
<img :src="bgUrl" alt="" id="bgImg"/>
<div id="bgOverlay"></div>

<!-- HoÅŸ Geldin Bilgilendirmesi -->
<div x-show="!selectedUniverse"
     class="fixed inset-0 flex items-center justify-center z-50">
  <div class="bg-black/85 text-white border border-white/10 rounded-2xl shadow-2xl p-6 text-sm w-[90%] max-w-2xl backdrop-blur-md space-y-4">
    <h2 class="text-2xl font-bold text-center">ðŸŽ¬ Film Evreni AÄŸÄ±'na HoÅŸ Geldin!</h2>
    <p class="text-base text-center text-white/80">Bu platform, farklÄ± sinematik evrenler arasÄ±nda baÄŸ kurmanÄ± ve yapÄ±mlarÄ± daha derinlemesine keÅŸfetmeni saÄŸlar.</p>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm mt-2">
      <div class="bg-white/10 rounded-lg p-4 border border-white/10">
        <h3 class="font-semibold mb-2">ðŸ—ºï¸ EtkileÅŸimli Harita</h3>
        <p>SeÃ§tiÄŸin evrene ait yapÄ±mlar arasÄ±ndaki baÄŸlantÄ±larÄ± grafik olarak gÃ¶rebilirsin.</p>
      </div>
      <div class="bg-white/10 rounded-lg p-4 border border-white/10">
        <h3 class="font-semibold mb-2">ðŸŽžï¸ YapÄ±m DetaylarÄ±</h3>
        <p>Her film veya diziye tÄ±klayarak Ã¶zet, oyuncular, gÃ¶ndermeler ve notlarÄ± gÃ¶rÃ¼ntÃ¼leyebilirsin.</p>
      </div>
      <div class="bg-white/10 rounded-lg p-4 border border-white/10">
        <h3 class="font-semibold mb-2">ðŸ“ Kendi NotlarÄ±nÄ± Ekle</h3>
        <p>YapÄ±mlara kiÅŸisel notlar ekleyebilir, dÃ¼zenleyebilir veya silebilirsin.</p>
      </div>
      <div class="bg-white/10 rounded-lg p-4 border border-white/10">
        <h3 class="font-semibold mb-2">â­ Favorilerine Ekle</h3>
        <p>Ä°zlemek istediÄŸin veya beÄŸendiÄŸin yapÄ±mlarÄ± favori listene ekleyebilirsin.</p>
      </div>
    </div>
    <p class="text-center text-white/60 text-sm pt-2">BaÅŸlamak iÃ§in yukarÄ±dan bir <strong>film evreni</strong> seÃ§ ðŸŒŒ</p>
<div class="text-center">
  <button @click="startTour()" class="mt-4 px-5 py-2 bg-white/10 border border-white/20 text-white text-sm rounded-lg hover:bg-white/20 transition">
    ðŸš€ Rehbere BaÅŸla
  </button>
</div>

  </div>
</div>

<header class="fixed top-4 left-0 right-0 z-50">
<div class="w-full sm:max-w-md lg:max-w-lg mx-auto px-3">
<div class="glass rounded-xl px-3 py-2">
<div class="flex flex-col gap-2">
<div class="flex items-center justify-center">
<h1 class="text-base sm:text-lg font-bold text-center">ðŸŽ¬ Film Evreni AÄŸÄ±</h1>
</div>
<div class="flex items-center gap-2">
<div class="relative w-full">
<input @blur="setTimeout(() =&gt; acOpen = false, 120)" @focus="acOpen = true" class="border rounded-lg px-3 py-1.5 w-full pr-8" placeholder="Ara..." type="search" x-model="search"/>
<button @click="search=''; suggestions=[]; applyFilters()" @mousedown.prevent="" aria-label="Temizle" class="absolute inset-y-0 right-2 my-auto h-6 w-6 rounded-full grid place-items-center opacity-80 hover:opacity-100 hover:bg-white/10" x-show="search">
<svg class="h-4 w-4" fill="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18.3 5.71a1 1 0 0 0-1.41 0L12 10.59 7.11 5.7A1 1 0 0 0 5.7 7.11L10.59 12l-4.9 4.89a1 1 0 1 0 1.41 1.41L12 13.41l4.89 4.9a1 1 0 0 0 1.41-1.41L13.41 12l4.9-4.89a1 1 0 0 0-.01-1.4Z"></path></svg>
</button>
<div class="ac-panel absolute z-50 w-full mt-1 rounded-lg overflow-hidden max-h-56 overflow-y-auto" x-show="acOpen &amp;&amp; search &amp;&amp; suggestions.length">
<template :key="s" x-for="(s, idx) in suggestions">
<div @click="search = s; acOpen=false; applyFilters();" @mousedown.prevent="" class="ac-item px-3 py-1.5"><span x-text="s"></span></div>
</template>
</div>
</div>
<div  @click.outside="open=false" @keydown.escape="open=false" class="relative min-w-[200px]" x-data="{ open:false, filterText:'' }">
<div  :aria-expanded="open" @click="open=!open" class="dropdown-btn border rounded-lg px-3 py-1.5 w-full flex items-center justify-between select-none">
<span id="#universe_select" class="truncate" x-text="selectedUniverse ? formatUniverseName(selectedUniverse) : 'TÃ¼m Evrenler'"></span>
<svg class="h-4 w-4 opacity-80 ml-2" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z" fill-rule="evenodd"></path></svg>
</div>
<div class="dropdown-panel absolute mt-2 left-0 right-0 rounded-xl overflow-hidden" style="z-index:60" x-show="open" x-transition="">
<div class="p-2 border-b border-white/10"><input class="w-full px-3 py-2 rounded-lg border" placeholder="Evren ara..." x-model="filterText"/></div>
<ul class="max-h-64 overflow-y-auto">
<template :key="u" x-for="u in universeList.filter(u =&gt; !filterText || formatUniverseName(u).toLowerCase().includes(filterText.toLowerCase()))">
<li @click="selectedUniverse=u; open=false; filterText=''; applyFilters()" class="dropdown-item px-3 py-2" x-text="formatUniverseName(u)"></li>
</template>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</header>
<div id="network" x-show="selectedUniverse" x-transition x-show="showGraph" x-transition></div>

<div @click.outside="if (!window.Shepherd?.activeTour) modalOpen = false" @keydown.escape.window="modalOpen=false" aria-labelledby="modalTitle" aria-modal="true" class="fixed inset-0 modal-bg flex items-center justify-center z-50 p-4" role="dialog" id="modal_container" x-show="modalOpen" x-transition="">
<div @click.stop="" class="modal-content" style="overflow-y: visible;">
<div class="relative rounded-xl overflow-hidden backdrop-blur-md bg-black/50 text-white max-h-[90vh] overflow-y-visible">
<!-- Ãœst blur gÃ¶rsel alanÄ± -->
<div class="relative h-64">
<img :src="modalNode.image" alt="" class="absolute inset-0 w-full h-full object-cover blur-xl brightness-50 scale-105"/>
<div class="absolute inset-0 flex flex-col justify-between p-4 z-10"><div class="absolute top-3 left-3 flex gap-2 items-center"><div class="flex gap-2 items-center">
<button @click="shareToX(modalNode)" class="text-white hover:opacity-80" title="X paylaÅŸ">
<img alt="X" src="https://img.icons8.com/ios-filled/20/ffffff/twitterx.png"/>
</button>
<button @click="shareToWhatsApp(modalNode)" class="text-white hover:opacity-80" title="WhatsApp">
<img alt="WA" src="https://img.icons8.com/ios-filled/20/ffffff/whatsapp.png"/>
</button>
<button @click="shareToLinkedIn(modalNode)" class="text-white hover:opacity-80" title="LinkedIn">
<img alt="IN" src="https://img.icons8.com/ios-filled/20/ffffff/linkedin.png"/>
</button>
<button @click="copyShare(modalNode)" class="text-white hover:opacity-80" title="Kopyala">ðŸ“‹</button>
</div></div><div class="absolute top-3 right-3 flex gap-2 items-center z-20"><div @click="modalOpen = false" class="close-btn" id="modal-close">âœ•</div></div>
<!-- Ãœst Ã§ubuk -->
<div class="flex justify-between items-start"><div class="absolute top-3 right-3 flex gap-2 items-center z-20"></div></div>
<!-- Alt bilgi -->
<div class="flex justify-between mt-4">
<div class="text-xs bg-black/40 px-3 py-1 rounded-full">
<div class="font-semibold text-white/70 text-[10px]">Vizyon Tarihi</div>
<span x-text="toTRDate(modalNode.release_date)">-</span>
</div>
<div class="text-xs flex gap-2 items-center bg-black/40 px-3 py-1 rounded-full">
<span x-text="modalNode.type || '-'"></span>
<span class="text-white/80">|</span>
<span x-text="'IMDB: ' + (modalNode.imdb_rating || '-')">IMDB</span>
</div>
</div>
</div>
<template x-if="showPosterDialog">
<div @click.self="showPosterDialog = false" class="fixed inset-0 z-\[9999\] z-\[999\] z-50 bg-black/70 backdrop-blur-md z-50 flex items-center justify-center">
<div class="p-4 rounded-xl shadow-2xl max-w-[90vw] max-h-[85vh]" style="z-index:10000;" style="z-index:1000;" style="z-index:60;">
<button @click="showPosterDialog = false" class="absolute top-2 right-2 w-8 h-8 rounded-full bg-white/10 border border-white/20 text-white text-sm">âœ•</button>
<img :src="modalNode.image" class="max-w-[75vw] max-h-[70vh] rounded-xl shadow-lg object-cover"/>
</div>
</div>
</template>
<!-- Poster -->
<div class="absolute left-1/2 top-full -translate-x-1/2 -translate-y-1/2 z-20"><div @click="showPosterDialog = true" class="cursor-pointer">
<div @click="showPosterDialog = true" class="cursor-pointer">
<div @click="showPosterDialog = true" class="cursor-pointer"><img :src="modalNode.image" alt=""
class="w-32 h-32 rounded-full object-cover drop-shadow-[0_0_20px_rgba(168,85,247,0.5)] ring-2 ring-purple-400/30"/></div></div>
</div>
</div>
</div>
<!-- Ä°Ã§erik alanÄ± -->
<div class="p-6 pt-20 space-y-6 overflow-hidden">
<h2 class="text-2xl font-bold text-center" x-text="modalNode.label">
</h2>
<div class="flex justify-center mt-2">
<button :class="isInWatchLater(modalNode?.id) ? 'bg-green-500 border-green-500 text-white' : 'bg-white/10 border-white/20 text-white hover:bg-white/20'" @click="toggleWatchLater(modalNode)" class="px-4 py-2 rounded border text-sm transition" x-text="isInWatchLater(modalNode?.id) ? 'âœ” Favorilere Eklendi' : 'Favorilere Ekle'">
</button>
</div>
<div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm">
<div class="bg-white/5 p-4 rounded-lg border border-white/10 space-y-1"><div><strong>TÃ¼r:</strong> <span x-text="modalNode.tÃ¼r || '-'"></span></div>
<div><strong>YÃ¶netmen:</strong> <span x-text="modalNode.yÃ¶netmen || '-'"></span></div>
<div><strong>Oyuncular:</strong> <span x-text="modalNode.oyuncular || '-'"></span></div>
</div>
<div class="bg-white/5 p-4 rounded-lg border border-white/10 space-y-1">
<div><strong>Evren:</strong> <span x-text="formatUniverseName(modalNode.universe)"></span></div>
<template x-if="modalNode.sources?.length">
<div><strong>Kaynaklar:</strong>
<ul class="list-disc list-inside">
<template :key="src.url" x-for="src in modalNode.sources">
<li><a :href="src.url" class="underline" target="_blank" x-text="src.name"></a></li>
</template>
</ul>
</div>
</template>
</div>
</div>
<!-- Ã–zet -->
<div>
<h3 @click="summaryOpen = !summaryOpen" id="content-summary" class="text-lg font-semibold mb-2 cursor-pointer flex justify-between items-center border-b border-white/10 pb-1 mb-4">Ä°Ã§erik Ã–zeti
<svg class="w-4 h-4 inline-block ml-2" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M19 9l-7 7-7-7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x-show="!summaryOpen"></path>
<path d="M5 15l7-7 7 7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x-show="summaryOpen"></path>
</svg>
</h3>
<div class="bg-white/5 p-4 rounded-lg border border-white/10" x-show="summaryOpen" x-text="modalNode.description || '-'"></div>
</div>
<!-- GÃ¶ndermeler -->
<template x-if="modalNode.refers_to">
<div>
<h3 @click="refersOpen = !refersOpen" id="gÃ¶ndermeler" class="text-lg font-semibold mb-2 cursor-pointer flex justify-between items-center border-b border-white/10 pb-1 mb-4">GÃ¶ndermeler
<svg class="w-4 h-4 inline-block ml-2" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M19 9l-7 7-7-7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x-show="!refersOpen"></path>
<path d="M5 15l7-7 7 7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x-show="refersOpen"></path>
</svg>
</h3><div class="text-sm text-red-400 italic mb-2" x-show="refersOpen">âš  Bu alan spoiler iÃ§erebilir.</div>
<div class="bg-white/5 p-4 rounded-lg border border-white/10 italic text-sm" x-show="refersOpen" x-text="modalNode.refers_to"></div>
</div>
</template>
<!-- BaÄŸlantÄ±lÄ± YapÄ±mlar -->


<h3 @click="linkedOpen = !linkedOpen" id="related-works" class="text-lg font-semibold mb-2 cursor-pointer flex justify-between items-center border-b border-white/10 pb-1 mb-4">BaÄŸlantÄ±lÄ± YapÄ±mlar
<svg class="w-4 h-4 inline-block ml-2" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M19 9l-7 7-7-7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x-show="!linkedOpen"></path>
<path d="M5 15l7-7 7 7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" x-show="linkedOpen"></path>
</svg>
</h3>
<div x-show="linkedOpen" class="bg-white/5 p-4 rounded-lg border border-white/10">

<template x-if="edgeList.length">
<div class="flex flex-wrap gap-2" x-show="linkedOpen">
<template :key="e.otherNodeId" x-for="e in edgeList">
<div :class="{
           'bg-blue-900/40 border-blue-500/30': e.type === 'Devam',
           'bg-yellow-900/30 border-yellow-400/20': e.type === 'Ã–ncesi',
           'bg-purple-900/30 border-purple-500/20': e.type === 'yan hikaye',
           'bg-green-900/30 border-green-500/20': e.type === 'karakter gÃ¶ndermesi',
           'bg-red-900/30 border-red-400/20': e.type === 'AynÄ± Evren',
           'bg-white/10 border-white/20': !e.type
         }" @click="__openNode(e.otherNodeId)" class="rounded-xl p-3 text-sm cursor-pointer transition relative border space-y-1">
<div class="font-semibold" x-text="nodes.get(e.otherNodeId)?.label || e.otherNodeId">
</div>
<div class="text-xs text-white/70 italic" x-text="e.type"></div>
<template x-if="e.notes">
<div class="border-l-4 border-blue-500 pl-2 ml-1 text-[12px] text-white/80 italic mt-1">
<span class="text-blue-300">Not:</span>
<span x-text="e.notes"></span>
</div>
</template>
</div>
</template>
</div>
</template>
<template x-if="!edgeList.length">
<p class="text-sm opacity-70">BaÄŸlantÄ± bulunamadÄ±.</p>
</template>
</div>
<!-- Notlar -->
<div class="bg-white/5 p-4 rounded-lg border border-white/10">
<h3 class="text-lg font-semibold mb-2">Notlar</h3>
<template x-if="!notes[modalNode.id] || !notes[modalNode.id].length">
<p class="text-sm opacity-70">HenÃ¼z not eklenmemiÅŸ.</p>
</template>

<template :key="i" x-for="(c, i) in (notes[modalNode.id] || [])">
  <div class="bg-white/10 p-2 rounded mb-2">
    <div class="text-xs opacity-70 mb-1">
      <span x-text="new Date(c.ts).toLocaleDateString()"></span>
    </div>
    <template x-if="editingNoteIndex === i">
      <div class="flex flex-col gap-2">
        <textarea x-model="editedNoteText" class="w-full p-2 rounded bg-black/20 text-sm text-white border border-white/20"></textarea>
        <div class="flex justify-end gap-2 text-xs">
          <button @click="saveEditedNote(modalNode.id, i)" class="px-2 py-1 rounded bg-green-600 hover:bg-green-700 text-white">Kaydet</button>
          <button @click="cancelEditNote()" class="px-2 py-1 rounded bg-white/20 text-white">VazgeÃ§</button>
        </div>
      </div>
    </template>
    <template x-if="editingNoteIndex !== i">
      <div>
        <div class="whitespace-pre-wrap text-sm" x-text="c.text"></div>
        <div class="flex justify-end gap-2 mt-1 text-xs opacity-80">
          <button @click="startEditNote(i, c.text)">âœï¸</button>
          <button @click="deleteNote(modalNode.id, i)">ðŸ—‘ï¸</button>
        </div>
      </div>
    </template>
  </div>
</template>

<div class="flex gap-2 mt-2">
<input class="w-full px-3 py-2 rounded bg-white/10 text-white" placeholder="Not ekle... #etiket" x-model="newNote"/>
<button @click="addNote(modalNode.id)" class="px-3 py-2 text-sm border border-white/20 rounded hover:bg-white/20">Ekle</button>
</div>
</div>
</div>
</div>
</div>
</div>

<div x-show="selectedUniverse">
</div>


</div>


<script>
    function app() {
      return {
    startTour() {
      const dropdown = document.querySelector('.dropdown-btn');
      dropdown?.classList.add('pointer-events-none', 'opacity-50');
      dropdown?.setAttribute('disabled', 'true');
      // Shepherd rehberi: BaÅŸtan sona adÄ±mlar

const tour = new Shepherd.Tour({
  defaultStepOptions: {
    scrollTo: true,
    cancelIcon: { enabled: true }
  }
});

// 1. HoÅŸ Geldin
tour.addStep({
  title: 'HoÅŸ Geldin ðŸŽ¬',
  text: 'Film Evreni AÄŸÄ±â€™na hoÅŸ geldin!',
  buttons: [{ text: 'Ä°leri', action: tour.next }]
});

// 2. Evren SeÃ§
tour.addStep({
  title: 'Evren SeÃ§ ðŸŒŒ',
  text: 'Buradan bir evren seÃ§ebilirsin.',
  attachTo: { element: '.dropdown-btn', on: 'bottom' },
  buttons: [{
    text: 'Devam',
    action: function () {
      const dropdown = document.querySelector('.dropdown-btn');
      dropdown?.classList.remove('pointer-events-none', 'opacity-50');
      dropdown?.removeAttribute('disabled');
      tour.next();
    }
  }]
});

// 3. Åžimdi Evren SeÃ§
tour.addStep({
  title: 'ðŸŒŒ Evren SeÃ§',
  text: 'LÃ¼tfen bir evren seÃ§.',
  attachTo: { element: '.dropdown-btn', on: 'left' }, // dropdown butonuna ID ver lÃ¼tfen
  scrollTo: false,
  buttons: [],
  when: {
    show() {
      const geÃ§erliMi = (val) => val && val !== '' && val !== 'all';

      const kontrolEt = () => {
        try {
          const selected = Alpine.store('selectedUniverse') || Alpine.raw(Alpine.$data(document.querySelector('[x-data]'))).selectedUniverse;

          if (geÃ§erliMi(selected)) {
            clearInterval(interval);
            tour.next();
          }
        } catch (e) {
          // Alpine hazÄ±r deÄŸilse sessizce bekle
        }
      };

      // DeÄŸer zaten uygunsa hemen geÃ§
      kontrolEt();

      // DeÄŸilse aralÄ±kla kontrol et
      const interval = setInterval(kontrolEt, 400);
    }
  }
});




// 4. Arama
tour.addStep({
  title: 'Film Ara ðŸ”',
  text: 'Film veya dizi aramak iÃ§in burayÄ± kullan.',
  attachTo: { element: 'input[type=search]', on: 'bottom' },
  buttons: [{ text: 'Devam', action: tour.next }]
});

// 5. YapÄ±m GrafiÄŸi
tour.addStep({
  title: 'YapÄ±m GrafiÄŸi ðŸ“Š',
  text: 'SeÃ§ilen evrene ait yapÄ±mlar bu aÄŸ grafiÄŸinde gÃ¶sterilir. <br><br> Bir yapÄ±ma tÄ±klayarak yapÄ±m bilgi panelini aÃ§.',
  attachTo: { element: '#network', on: 'top' },
  scrollTo: false,
  buttons: [], // Buton gÃ¶stermiyoruz
  when: {
    show() {
      const checkModalOpen = () => {
        const modal = document.querySelector('.modal-content');
        const h2 = modal?.querySelector('h2');
        const isVisible = modal && getComputedStyle(modal).display !== 'none';
        const hasTitle = h2 && h2.textContent.trim().length > 0;
        return isVisible && hasTitle;
      };

      if (checkModalOpen()) {
        tour.next(); // Zaten aÃ§Ä±k ve iÃ§erik varsa direkt geÃ§
        return;
      }

      // AralÄ±kla kontrol et
      const interval = setInterval(() => {
        if (checkModalOpen()) {
          clearInterval(interval);
          tour.next();
        }
      }, 400);
    }
  }
});



// 8. PaylaÅŸÄ±m
tour.addStep({
  title: 'PaylaÅŸÄ±m ðŸš€',
  text: 'Bu butonla yapÄ±m baÄŸlantÄ±sÄ±nÄ± kopyalayabilir veya sosyal medyada paylaÅŸabilirsin.',
  attachTo: { element: 'button[title="Kopyala"]', on: 'bottom' },
  buttons: [{ text: 'Devam', action: tour.next }]
});

// 9. Vizyon Tarihi
tour.addStep({
  title: 'ðŸŽ¬ Vizyon Tarihi',
  text: 'Burada yapÄ±mÄ±n vizyon tarihini gÃ¶rebilirsin.',
  attachTo: { element: '.modal-content [x-text*=toTRDate]', on: 'bottom' },
  buttons: [{ text: 'Devam', action: tour.next }]
});

// 10. TÃ¼r ve IMDB
tour.addStep({
  title: 'â­ TÃ¼r ve IMDB',
  text: 'YapÄ±mÄ±n tÃ¼rÃ¼ ve IMDB puanÄ± burada.',
  attachTo: { element: '.modal-content .text-xs.flex', on: 'bottom' },
  buttons: [{ text: 'Devam', action: tour.next }]
});

// 6. Favorilere Ekle
tour.addStep({
  title: 'Favorilere Ekle â­',
  text: 'Bir yapÄ±mÄ± favorilerine eklemek iÃ§in bu butonu kullan.',
  attachTo: { element: '[x-text*=Favorilere]', on: 'bottom' },
  buttons: [{
    text: 'Devam',
    action: function () {
      const btn = document.querySelector('[x-text*=Favorilere]');
      if (btn && btn.textContent.includes('âœ” Favorilere Eklendi')) {
        return tour.next();
      } else {
        alert('LÃ¼tfen Ã¶nce favorilere ekle.');
      }
    }
  }]
});

// 11. TÃ¼r / YÃ¶netmen / Oyuncular
tour.addStep({
  title: 'ðŸŽ­ TÃ¼r, YÃ¶netmen, Oyuncular',
  text: 'Bu bÃ¶lÃ¼mde temel bilgiler yer alÄ±r.',
  attachTo: { element: '.modal-content .grid > div:nth-child(1)', on: 'bottom' },
  buttons: [{ text: 'Devam', action: tour.next }]
});

// 12. Evren ve Kaynaklar
tour.addStep({
  title: 'ðŸŒŒ Evren ve Kaynaklar',
  text: 'YapÄ±mÄ±n ait olduÄŸu evreni ve kaynaklarÄ± burada gÃ¶rebilirsin.',
  attachTo: { element: '.modal-content .grid > div:nth-child(2)', on: 'bottom' },
  buttons: [{ text: 'Devam', action: tour.next }]
});

// 13. Ä°Ã§erik Ã–zeti
tour.addStep({
  title: "ðŸ“ Ä°Ã§erik Ã–zeti",
  text: "Burada filmin kÄ±sa Ã¶zeti yer alÄ±r.",
  attachTo: {
    element: "#content-summary",
    on: "bottom"
  },
  buttons: [{ text: 'Devam', action: tour.next }]
});

// 14. GÃ¶ndermeler
tour.addStep({
  title: "ðŸŽ¯ GÃ¶ndermeler",
  text: "Filmde yapÄ±lan diÄŸer yapÄ±mlara gÃ¶ndermeleri burada gÃ¶rebilirsiniz.",
  attachTo: {
    element: "#gÃ¶ndermeler",
    on: "bottom"
  },
  buttons: [{ text: 'Devam', action: tour.next }]
});

// 15. BaÄŸlantÄ±lÄ± YapÄ±mlar
tour.addStep({
  title: "ðŸ”— BaÄŸlantÄ±lÄ± YapÄ±mlar",
  text: "Ä°lgili evrende geÃ§en diÄŸer yapÄ±mlar bu bÃ¶lÃ¼mde gÃ¶sterilir.",
  attachTo: {
    element: "#related-works",
    on: "bottom"
  },
  buttons: [{ text: 'Devam', action: tour.next }]
});


// 7. Not Ekle
tour.addStep({
  title: 'Not Ekle ðŸ“',
  text: 'Buraya kiÅŸisel notlarÄ±nÄ± yazabilir, #etiket ekleyebilirsin.',
  attachTo: { element: 'input[placeholder="Not ekle... #etiket"]', on: 'bottom' },
  buttons: [{
    text: 'Devam',
    action: function () {
      try {
        const items = Array.from(document.querySelectorAll('.modal-content div'));
        const validNotes = items.filter(el =>
          el.classList.contains('bg-white/10') &&
          el.classList.contains('p-2') &&
          el.classList.contains('rounded') &&
          el.classList.contains('mb-2')
        );
        if (validNotes.length > 0) {
          return tour.next();
        } else {
          alert('LÃ¼tfen en az bir not ekleyin ve gÃ¶rÃ¼nÃ¼r hale getirin.');
        }
      } catch (err) {
        alert('Bir hata oluÅŸtu: ' + err.message);
      }
    }
  }]
});


// 16. YapÄ±m Panelini Kapat
tour.addStep({
  title: 'ðŸ“• YapÄ±m Panelini Kapat',
  text: 'Bu paneli kapatarak bir sonraki adÄ±ma geÃ§ebilirsin.',
  attachTo: { element: '#modal-close', on: 'top' },
  scrollTo: true,
  buttons: [],
  when: {
    show() {
      let modal;

      const interval = setInterval(() => {
        modal = document.querySelector('#modal_container');

        // Modal DOM'da bile deÄŸilse â†’ kapandÄ± demektir
        if (!modal) {
          clearInterval(interval);
          tour.next();
          return;
        }

        // Modal DOM'da ama gÃ¶rÃ¼nmÃ¼yorsa
        const style = window.getComputedStyle(modal);
        const isHidden =
          style.display === 'none' ||
          style.visibility === 'hidden' ||
          style.opacity === '0' ||
          modal.classList.contains('hidden') ||
          modal.offsetWidth === 0 ||
          modal.offsetHeight === 0;

        if (isHidden) {
          clearInterval(interval);
          tour.next();
        }
      }, 300);
    }
  }
});





// 17. Oklar (Ä°liÅŸkiler)
tour.addStep({
  title: 'Oklar Neyi GÃ¶sterir? ðŸ”',
  text: 'Grafikteki oklar yapÄ±mlar arasÄ±ndaki iliÅŸkiyi gÃ¶sterir.',
  attachTo: { element: '#network canvas', on: 'top' },
  buttons: [{ text: 'Devam', action: tour.next }]
});

// 18. Legend AlanÄ±
tour.addStep({
  title: 'ðŸ“˜ BaÄŸlantÄ±lar AÃ§Ä±klamasÄ±',
  text: 'BaÄŸlantÄ±lar alanÄ± evren renklerini ve tÃ¼rlerini aÃ§Ä±klar.',
  attachTo: { element: '#legend_bar', on: 'left' },
  buttons: [{ text: 'Devam', action: tour.next }]
});

// 19. Favori ve Not Paneli
tour.addStep({
  title: 'ðŸ“‚ SaÄŸ Alt Panel',
  text: 'SaÄŸ altta favori ve notlarÄ± gÃ¶rmek iÃ§in bu alanÄ± kullanabilirsin.',
  attachTo: { element: '#panel_bar', on: 'top' },
  scrollTo: false,
  buttons: [
    {
      text: 'Devam',
      action: function () {
        // Panel iÃ§eriÄŸi DOM'da gÃ¶rÃ¼nÃ¼r mÃ¼ kontrol et
        const panel = document.querySelector('[x-show="panelOpen"]');

        const isVisible = panel && window.getComputedStyle(panel).display !== 'none';

        if (isVisible) {
          tour.next();
          return;
        }

        alert('LÃ¼tfen Ã¶nce paneli aÃ§malÄ±sÄ±n.');

        // Panel aÃ§Ä±ldÄ±ÄŸÄ±nda bekle ve sonra ilerle
        const interval = setInterval(() => {
          const nowVisible = panel && window.getComputedStyle(panel).display !== 'none';
          if (nowVisible) {
            clearInterval(interval);
            tour.next();
          }
        }, 400); // her 0.4 sn'de bir kontrol et
      }
    }
  ]
});






// 20. Favori YÃ¶netimi
tour.addStep({
  title: 'â­ Favorileri GÃ¶r ve Sil',
  text: 'Bu alanda favori yapÄ±mlarÄ± gÃ¶rebilir ve silebilirsin.',
  attachTo: { element: '#fav_bar', on: 'left' },
  buttons: [{ text: 'Devam', action: tour.next }]
});

// 21. Not YÃ¶netimi
tour.addStep({
  title: 'ðŸ“ NotlarÄ± GÃ¶r, DÃ¼zenle, Sil',
  text: 'NotlarÄ±nÄ± bu alanda gÃ¶rÃ¼ntÃ¼leyebilir, dÃ¼zenleyebilir ya da silebilirsin.',
  attachTo: { element: '#notlar_bar', on: 'left' },
  buttons: [{ text: 'Devam', action: tour.next }]
});

// 22. Tur Bitti ðŸŽ‰
tour.addStep({
  title: 'Tebrikler! ðŸŽ‰',
  text: 'Film Evreni AÄŸÄ± rehberini baÅŸarÄ±yla tamamladÄ±n. KeÅŸfetmeye hazÄ±rsÄ±n!',
  buttons: [{ text: 'Kapat', action: tour.complete }]
});
      tour.start();
    },

 

    editingNoteIndex: null,
    editedNoteText: '',
    startEditNote(i, text) {
      this.editingNoteIndex = i;
      this.editedNoteText = text;
    },
    cancelEditNote() {
      this.editingNoteIndex = null;
      this.editedNoteText = '';
    },
    saveEditedNote(nodeId, i) {
      if (this.notes[nodeId] && this.notes[nodeId][i]) {
        this.notes[nodeId][i].text = this.editedNoteText;
        this.notes[nodeId][i].ts = Date.now();
        this.cancelEditNote();
        if (this.saveNotesToStorage) this.saveNotesToStorage();
      }
    },
    
        linkedOpen: window.innerWidth > 640,
        showFavAdded: false,
        showFavMsg: false,

        summaryOpen: window.innerWidth > 640,
        refersOpen: false,
        showPosterDialog: false,
    
        network: null, allNodes: [], allEdges: [], nodes: null, edges: null,
        filteredNodes: [], filteredEdges: [],
        search: '', selectedUniverse: '', modalOpen: false, modalNode: null,
        timelineOpen: false,
        universeList: [], fitTimeout: null, showLegend: true,
        suggestions: [], acOpen: false,
        watchLater: [], watchLaterOpen: false, panelOpen: false, activeTab: 'watch', showGraph: false,
        notes: {}, newNote: '', notesOpen: false, notesUniverseFilter: '', notesTagFilter: '', editingNoteIndex: null, editedNoteText: '',
        bgUrl: 'images/bg.jpg',
        bgMap: {
          "": "images/bg.jpg",
          "avatar_last_airbender": "images/avatar.jpg",
          "avatar_pandora": "images/pandora.jpg",
          "dc": "images/dc.jpg",
          "harrypotter": "images/harrypotter.jpg",
          "marvel": "images/marvel.jpg",
          "matrix": "images/matrix.jpg",
          "middleearth": "images/middleearth.jpg",
          "pixar": "images/pixar.jpg",
          "starwars": "images/starwars.jpg"
        },
        get edgeList(){
          if (!this.modalNode || !this.allEdges) return [];
          return this.allEdges
            .filter(e => e.from === this.modalNode.id || e.to === this.modalNode.id)
            .map(e => ({ ...e, otherNodeId: e.from === this.modalNode.id ? e.to : e.from }));
        },
        edgeColors: {
          "Devam": "#2980b9",
          "Ã–ncesi": "#f39c12", "Ã¶n hikaye": "#e67e22", "yan hikaye": "#8e44ad",
          "AynÄ± Evren": "#c0392b", "gÃ¶rsel gÃ¶nderme": "#7f8c8d", "karakter gÃ¶ndermesi": "#27ae60",
          "kurumsal gÃ¶nderme": "#6e4b25", "zaman Ã§izgisi baÄŸlantÄ±sÄ±": "#1abc9c", "remake": "#2ecc71",
          "Teori BaÄŸlantÄ±sÄ±": "#f1c40f", "duygu ve bilinÃ§ temasÄ±": "#9b59b6", "konseptsel Devam": "#34495e",
          "ÅŸehir yaÅŸamÄ± paralelliÄŸi": "#d35400", "karakter_baÄŸlantÄ±sÄ±": "#7d3c98",
          "Tema OrtaklÄ±ÄŸÄ±": "#e84393"
        },
        edgeStyles: {
          "Devam": { width: 3, dashes: false },
          "Ã–ncesi": { width: 2, dashes: [4, 6] }, "karakter geÃ§iÅŸi": { width: 3, dashes: [10,4] },
          "evren geÃ§iÅŸi": { width: 2.5, dashes: [6,4] }, "multiverse birleÅŸmesi": { width: 2.5, dashes: [2,6] },
          "gÃ¶rsel gÃ¶nderme": { width: 1.8, dashes: [2,6] }, "karakter gÃ¶ndermesi": { width: 2, dashes: [6,6] },
          "Ã¶n hikaye": { width: 2.2, dashes: false }, "yan hikaye": { width: 2, dashes: [8,6] },
          "tematik benzerlik": { width: 1.8, dashes: [12,6] }, "Teori BaÄŸlantÄ±sÄ±": { width: 1.8, dashes: [4,4] },
          "kurumsal gÃ¶nderme": { width: 1.8, dashes: [2,8] }, "konseptsel Devam": { width: 2, dashes: false },
          "ÅŸehir yaÅŸamÄ± paralelliÄŸi": { width: 1.8, dashes: [10,8] }, "iÃ§ film/karakter kÃ¶keni": { width: 2, dashes: [5,5] },
          "paralel Kang anlatÄ±mÄ±": { width: 2.5, dashes: [3,7] }
        },
        get timelineSortedNodes(){
          const u = this.selectedUniverse;
          return [...this.allNodes]
            .filter(n => n.release_date && (!u || n.universe === u))
            .sort((a, b) => new Date(a.release_date) - new Date(b.release_date));
        },
        get groupTimelineByYear(){
          const groups = new Map();
          for (const n of this.timelineSortedNodes) {
            const y = new Date(n.release_date).getFullYear();
            if (!groups.has(y)) groups.set(y, []);
            groups.get(y).push(n);
          }
          for (const [y, arr] of groups.entries()) { arr.sort((a,b)=> new Date(a.release_date) - new Date(b.release_date)); }
          return Array.from(groups.entries()).sort((a,b)=> b[0]-a[0]);
        },
        
get legendEntries() {
  const usedTypes = new Set(this.filteredEdges.map(e => e.type));
  return Object.entries(this.edgeColors).filter(([t]) =>
    usedTypes.has(t) || this.filteredEdges.length === 0
  );
}
,
        get notesSummary(){
          const groups = new Map();
          for (const [nodeId, arr] of Object.entries(this.notes)){
            if (!arr || !arr.length) continue;
            const node = this.nodes?.get(nodeId) || this.allNodes.find(n => String(n.id)===String(nodeId));
            const g = groups.get(nodeId) || { count: 0, tags: new Set(), label: node?.label || nodeId, universe: node?.universe || '' };
            g.count += arr.length;
            for (const n of arr) (n.tags||[]).forEach(t => g.tags.add(t));
            groups.set(nodeId, g);
          }
          const u = this.notesUniverseFilter;
          const tagQ = (this.notesTagFilter || '').trim().replace(/^#/, '').toLowerCase();
          return Array.from(groups.entries()).map(([nodeId, g]) => ({ nodeId, label: g.label, universe: g.universe, count: g.count, tags: Array.from(g.tags) }))
            .filter(x => (!u || x.universe === u) && (!tagQ || x.tags.some(t => t.includes(tagQ))))
            .sort((a,b)=> b.count - a.count || a.label.localeCompare(b.label));
        },
        getAllEdgesWithNotes(nodeId) {
          if (!nodeId) return [];
          return this.allEdges
            .filter(e => e.from === nodeId || e.to === nodeId)
            .map(e => {
              const otherNodeId = e.from === nodeId ? e.to : e.from;
              const otherNode = this.allNodes.find(n => String(n.id) === String(otherNodeId));
              return {
        linkedOpen: window.innerWidth > 640,
        showFavAdded: false,
        showFavMsg: false,

        summaryOpen: window.innerWidth > 640,
        refersOpen: false,
        showPosterDialog: false,
     id: e.id || (e.from + "_" + e.to + "_" + (e.type || "")), otherNodeId, otherNodeLabel: otherNode?.label || otherNodeId, type: e.type, edgeHasNotes: !!e.notes, edgeNoteText: e.notes || "", nodeHasNotes: !!(this.notes && this.notes[otherNodeId] && this.notes[otherNodeId].length) };
            });
        },
        formatEdgeType(type) { if (!type) return ''; return type.charAt(0).toUpperCase() + type.slice(1); },
        get topTags(){
          const counts = new Map();
          const u = this.notesUniverseFilter;
          for (const [nodeId, arr] of Object.entries(this.notes)){
            if (!arr || !arr.length) continue;
            const node = this.allNodes.find(n => String(n.id) === String(nodeId));
            if (u && node?.universe !== u) continue;
            for (const n of arr) for (const t of (n.tags || [])) counts.set(t, (counts.get(t) || 0) + 1);
          }
          return Array.from(counts.entries()).sort((a,b) => b[1] - a[1]).slice(0, 10).map(([t]) => t);
        },
        init() {
          this.showLegend = true;
          try { const old = localStorage.getItem('comments'); if (old && !localStorage.getItem('notes')) { localStorage.setItem('notes', old); localStorage.removeItem('comments'); } } catch {}
          this.loadWatchLater(); this.loadNotes(); this.network = null;
          this.setBackgroundFor(this.selectedUniverse); this.warmBackgrounds();
          this.loadData();

this.setupNetwork();
this.applyFilters();

          let debounceTimeout = null;
          this.$watch('search', (val) => {
            clearTimeout(debounceTimeout);
            debounceTimeout = setTimeout(() => {
              this.applyFilters();
              if (val) {
                const lower = val.toLowerCase(), starts = [], contains = [], seen = new Set();
                for (const n of this.allNodes) {
                  const lbl = n.label; if (!lbl) continue; const l = lbl.toLowerCase();
                  if (l.startsWith(lower)) { if (!seen.has(lbl)) { starts.push(lbl); seen.add(lbl); } }
                  else if (l.includes(lower)) { if (!seen.has(lbl)) { contains.push(lbl); seen.add(lbl); } }
                  if (starts.length + contains.length >= 10) break;
                }
                this.suggestions = [...starts, ...contains];
              } else this.suggestions = [];
            }, 220);
          });
          
this.$watch('selectedUniverse', (val) => {
  if (val) {
    this.setBackgroundFor(val);
    if (!this.network) this.setupNetwork();
    this.applyFilters();
  }
  this.notesUniverseFilter = val;
});

        },
        async setBackgroundFor(universe){
          const primary = this.bgMap[universe || ""] || this.bgMap[""];
          const fallbacks = ["images/bg.jpg", "images/bg.jpg"];
          const tried = new Set();
          const tryLoad = (url) => new Promise((resolve,reject)=>{ if(!url || tried.has(url)) return reject(); tried.add(url); const img = new Image(); img.onload = () => resolve(url); img.onerror = () => reject(); img.decoding = 'async'; img.referrerPolicy = 'no-referrer'; img.src = url; });
          for (const url of [primary, ...fallbacks]) { try { const ok = await tryLoad(url); this.bgUrl = ok; return; } catch {} }
        },
        warmBackgrounds(){ [...new Set(Object.values(this.bgMap))].forEach(u => { const i = new Image(); i.decoding='async'; i.src = u; }); },
        loadWatchLater(){ try { this.watchLater = JSON.parse(localStorage.getItem('watchLater') || '[]'); } catch { this.watchLater = []; } },
        saveWatchLater(){ localStorage.setItem('watchLater', JSON.stringify(this.watchLater)); },
        isInWatchLater(id){ return !!this.watchLater.find(x => String(x.id) === String(id)); },
        toggleWatchLater(node){ if (!node?.id) return; if (this.isInWatchLater(node.id)) this.watchLater = this.watchLater.filter(x => String(x.id) !== String(node.id)); else this.watchLater.unshift({ id: node.id, label: node.label || String(node.id) }); this.saveWatchLater(); },
        removeWatchLater(id){ this.watchLater = this.watchLater.filter(x => String(x.id) !== String(id)); this.saveWatchLater(); },
        loadNotes(){ try { this.notes = JSON.parse(localStorage.getItem('notes')||'{}'); } catch { this.notes = {}; } },
        saveNotes(){ localStorage.setItem('notes', JSON.stringify(this.notes)); },
        extractTags(t){ return Array.from(t.matchAll(/#([\p{L}\d_-]+)/gu)).map(m=>m[1].toLowerCase()); },
        addNote(nodeId){ const t = (this.newNote || '').trim(); if (!nodeId || !t) return; const item = { text: t, tags: this.extractTags(t), pin: false, ts: Date.now(), editedTs: null }; (this.notes[nodeId] ||= []).unshift(item); this.newNote = ''; this.saveNotes(); },
        togglePin(nodeId, idx){ const n = this.notes[nodeId]?.[idx]; if (!n) return; n.pin = !n.pin; this.saveNotes(); },
        deleteNote(nodeId, idx){ this.notes[nodeId].splice(idx, 1); this.saveNotes(); },
        startEditNote(index, text) {
          this.editingNoteIndex = index;
          this.editedNoteText = text;
        },
        cancelEditNote() {
          this.editingNoteIndex = null;
          this.editedNoteText = '';
        },
        saveEditedNote(nodeId, index) {
          if (!this.notes[nodeId] || !this.notes[nodeId][index]) return;
          const updatedText = (this.editedNoteText || '').trim();
          if (!updatedText) return;
          this.notes[nodeId][index].text = updatedText;
          this.notes[nodeId][index].tags = this.extractTags(updatedText);
          this.notes[nodeId][index].editedTs = Date.now();
          this.saveNotes();
          this.cancelEditNote();
        },

        buildNodeUrl(nodeId){ const node = this.nodes?.get(nodeId) || this.allNodes.find(n => String(n.id)===String(nodeId)); const u = node?.universe || ''; const base = location.origin + location.pathname; const params = new URLSearchParams({ u, node: String(nodeId) }); return `${base}?${params.toString()}`; },
        shareNode(node, platform){ if (!node?.id) return; const url = this.buildNodeUrl(node.id); const text = `${node.label || node.id} â€” ${this.formatUniverseName(node.universe)}\n${url}`; const enc = encodeURIComponent(text); const shareUrl = platform === 'whatsapp' ? `https://api.whatsapp.com/send?text=${enc}` : platform === 'x' ? `https://twitter.com/intent/tweet?text=${enc}` : ''; if (shareUrl) window.open(shareUrl, '_blank', 'noopener'); },
        async loadData() {
          const evrenler = ["avatar_last_airbender","avatar_pandora","dc","harrypotter","marvel","matrix","middleearth","pixar","starwars"];
          try {
            const results = await Promise.all(evrenler.map(evren => fetch('data/' + evren + '.json', { cache: 'no-store' }).then(r => { if (!r.ok) throw new Error(evren + ' yÃ¼klenemedi'); return r.json().then(data => ({ evren, data })); })));
            let nodesTemp = [], edgesTemp = [];
            for (const { evren, data } of results) { nodesTemp = nodesTemp.concat(data.nodes.map(n => ({ ...n, universe: evren }))); edgesTemp = edgesTemp.concat(data.edges); }
            this.allNodes = nodesTemp; this.allEdges = edgesTemp; this.universeList = [...new Set(this.allNodes.map(n => n.universe))];
            this.allNodes.filter(n => n.image).forEach(n => { const i = new Image(); i.decoding='async'; i.src = n.image; });
            
            const params = new URLSearchParams(location.search);
            const qU = params.get('u'); const qNode = params.get('node');
            if (qU && this.universeList.includes(qU)) this.selectedUniverse = qU;
            this.applyFilters();
            if (qNode && (this.nodes?.get(qNode))) { this.modalNode = this.nodes.get(qNode); this.modalOpen = true; this.network.selectNodes([qNode]); this.network.focus(qNode, { animation: true, scale: 1 }); }
          } catch (err) { console.error(err); alert('Veri yÃ¼kleme hatasÄ±: ' + err.message); }
        },
        openNode(id) { const node = this.nodes?.get(id) || this.allNodes.find(n => String(n.id) === String(id)); if (node) { this.modalNode = node; this.modalOpen = true; window.__modalWasOpened = true; this.network?.selectNodes([id]); this.network?.focus(id, { animation: true, scale: 1 }); } },
        makeOptions() { return {
        linkedOpen: window.innerWidth > 640,
        showFavAdded: false,
        showFavMsg: false,

        summaryOpen: window.innerWidth > 640,
        refersOpen: false,
        showPosterDialog: false,
     nodes: { size: 25, font: { color: '#e5e7eb', size: 14 }, borderWidthSelected: 6, color: { border: '#ef4444' } }, edges: { arrows: { to: { enabled: true, scaleFactor: 0.5 } }, smooth: { enabled: true, type: 'dynamic' } }, interaction: { hover: true, tooltipDelay: 200, zoomView: true, dragView: true }, physics: { stabilization: true, barnesHut: { gravitationalConstant: -4000 } }, layout: { improvedLayout: true } }; },
        setupNetwork() { this.nodes = new vis.DataSet(); this.edges = new vis.DataSet(); const container = document.getElementById('network'); this.network = new vis.Network(container, { nodes: this.nodes, edges: this.edges }, this.makeOptions()); this.network.on('click', params => { if (params.nodes.length > 0) { const node = this.nodes.get(params.nodes[0]); requestAnimationFrame(() => { this.modalNode = node; this.modalOpen = true; }); } }); },
        applyFilters() {
          if (!this.nodes || !this.edges) return;
          const searchTerm = (this.search || '').toLowerCase(); const universe = this.selectedUniverse;
          this.filteredNodes = this.allNodes.filter(n => (!universe || n.universe === universe) && (!searchTerm || (n.label && n.label.toLowerCase().includes(searchTerm))));
          const nodeIds = new Set(this.filteredNodes.map(n => n.id));
          this.filteredEdges = this.allEdges.filter(e => nodeIds.has(e.from) && nodeIds.has(e.to));
          this.updateNetwork();
          if (this.network) { if (this.fitTimeout) clearTimeout(this.fitTimeout); this.fitTimeout = setTimeout(() => this.network.fit({ animation: true }), 220); }
        },
        updateNetwork() {
          this.nodes.clear(); this.edges.clear();
          this.nodes.add(this.filteredNodes.map(n => { const hasImage = !!n.image; const noteCount = (this.notes[n.id]?.length || 0); return {
        linkedOpen: window.innerWidth > 640,
        showFavAdded: false,
        showFavMsg: false,

        summaryOpen: window.innerWidth > 640,
        refersOpen: false,
        showPosterDialog: false,
     ...n, label: noteCount ? `${n.label}\nðŸ“ ${noteCount}` : n.label, font: { color: '#e5e7eb', size: 14, multi: true, vadjust: 4 }, shape: hasImage ? 'circularImage' : 'dot', borderWidth: 2, borderWidthSelected: 6, color: hasImage ? { border: '#ef4444' } : { background: '#ef4444', border: '#ef4444' } }; }));
          this.edges.add(this.filteredEdges.map(e => { const color = this.edgeColors[e.type] || '#9ca3af'; const s = this.edgeStyles[e.type] || { width: 1.5, dashes: false }; return {
        linkedOpen: window.innerWidth > 640,
        showFavAdded: false,
        showFavMsg: false,

        summaryOpen: window.innerWidth > 640,
        refersOpen: false,
        showPosterDialog: false,
     ...e, arrows: 'to', color: { color }, width: s.width, dashes: s.dashes }; }));
        },
        neighborChips(nodeId) { if (!nodeId || !this.network) return ''; const neighbors = this.network.getConnectedNodes(nodeId).map(id => this.nodes.get(id)).filter(Boolean); if (!neighbors.length) return '<span class="text-sm opacity-70">BaÄŸlantÄ± bulunamadÄ±.</span>'; return neighbors.map(n => `<button class="chip hover:brightness-110" onclick="window.__openNode('${String(n.id).replace(/'/g,'&#39;')}')">${n.label ? n.label.replace(/</g,'&lt;') : 'ID ' + n.id}</button>`).join(''); },
        formatUniverseName(name) { const map = { "avatar_last_airbender": "Avatar: Son Hava BÃ¼kÃ¼cÃ¼", "avatar_pandora": "Avatar (Pandora)", "dc": "DC", "marvel": "Marvel", "harrypotter": "Harry Potter", "matrix": "Matrix", "middleearth": "Orta DÃ¼nya", "pixar": "Pixar", "starwars": "Star Wars" }; return map[name] || name; }
      }
    }
    window.openNode = function(id) { const scope = document.querySelector('html')?.__x?.$data; if (!scope?.openNode) return; scope.openNode(id); };
    window.__openNode = function(id) { let scope = document.querySelector('html')?.__x?.$data; if (!scope?.nodes) { for (const el of document.querySelectorAll('[x-data]')) { if (el.__x && el.__x.$data?.nodes) { scope = el.__x.$data; break; } } } if (!scope?.nodes) return; const node = scope.nodes.get(id); if (node) { requestAnimationFrame(() => { scope.modalNode = node; scope.modalOpen = true; scope.network.selectNodes([id]); scope.network.focus(id, { animation: true, scale: 1 }); }); } };
  </script>
<script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js')
          .then(reg => console.log('SW registered', reg.scope))
          .catch(err => console.warn('SW register failed', err));
      });
    }
  </script>
<script>
    const SHARE_PHRASES = { more: 'DevamÄ± iÃ§in ziyaret et:', farewell: 'Sinemayla kalÄ±n.', dash: ' â€” ' };
    const EMOJI = { title: 'ðŸŽ¬', date: 'ðŸ“…', summary: 'ðŸ“', more: 'ðŸ‘‰', link: 'ðŸ”—', bye: 'ðŸ¿' };
    function preferredUrl(node) { const base = typeof window !== 'undefined' ? window.location.origin + window.location.pathname : ''; const id = node?.id ? `#${node.id}` : ''; return node?.url || base + id; }
    function composeShareText(node) {
      const filmAdi  = node?.label || node?.title || node?.name || 'Bu yapÄ±m';
      const line1 = `${EMOJI.title} ${filmAdi}`;
      const takvimTR = toTRDate(node?.release_date || node?.date);
      const line2 = takvimTR ? `${EMOJI.date} ${takvimTR}` : '';
      const aciklamaFull = (node?.description || '').trim();
      const gondermelerFull = (node?.refers_to || '').trim();
      const aciklama = aciklamaFull.length > 120 ? aciklamaFull.slice(0,117).trimEnd() + '...' : aciklamaFull;
      const gondermeler = gondermelerFull.length > 100 ? gondermelerFull.slice(0,97).trimEnd() + '...' : gondermelerFull;
      let line3 = '';
      if (aciklama && gondermeler) line3 = `${EMOJI.summary} Film Ã–zeti: ${aciklama}${SHARE_PHRASES.dash}GÃ¶ndermeler: ${gondermeler}`;
      else if (aciklama) line3 = `${EMOJI.summary} Film Ã–zeti: ${aciklama}`;
      else if (gondermeler) line3 = `${EMOJI.summary} GÃ¶ndermeler: ${gondermeler}`;
      if (line3 && !/[.!?â€¦]$/.test(line3.trim())) line3 = line3.trim() + '.';
      const url = preferredUrl(node);
      const line4 = `${SHARE_PHRASES.more} ${EMOJI.more}`;
      const line5 = `${EMOJI.link} ${url}`;
      const line6 = `${SHARE_PHRASES.farewell} ${EMOJI.bye}`;
      return [line1, line2, line3, line4, line5, line6].filter(Boolean).join('\n');
    }
    function composeShareTextForX(node, max = 240) { const url = preferredUrl(node); const single = composeShareText(node).replace(/\n+/g, ' | '); const withoutUrl = single.replace(url, '').replace(/\s*\|\s*\|\s*/g, ' | ').trim(); return withoutUrl.length <= max ? withoutUrl : (withoutUrl.slice(0, max - 1) + 'â€¦'); }
    window.shareToX = function(node) { const url = preferredUrl(node); const text = composeShareTextForX(node); window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`,'_blank','noopener,noreferrer'); };
    window.shareToWhatsApp = function(node) { const text = composeShareText(node); window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent(text)}`,'_blank','noopener,noreferrer'); };
    window.shareToLinkedIn = function(node) { const url  = preferredUrl(node); const name = node?.label || node?.title || node?.name || 'Bu yapÄ±m'; const sum  = composeShareText(node); window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}&title=${encodeURIComponent(name)}&summary=${encodeURIComponent(sum)}`,'_blank','noopener,noreferrer'); };
    window.copyShare = async function(node) { const full = composeShareText(node) + '\n'; try { await navigator.clipboard.writeText(full); alert('PaylaÅŸÄ±m metni ve link kopyalandÄ±.'); } catch { const ta = document.createElement('textarea'); ta.value = full; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta); alert('PaylaÅŸÄ±m metni ve link kopyalandÄ±.'); } };
  </script>
<script>
    window.toTRDate = function(value) { if (!value) return ''; const s = String(value).trim(); const m = /^(\d{4})-(\d{2})-(\d{2})$/.exec(s); if (m) return `${m[3]}/${m[2]}/${m[1]}`; const d = new Date(s); if (isNaN(d)) return s; const dd = String(d.getDate()).padStart(2, '0'); const mm = String(d.getMonth() + 1).padStart(2, '0'); const yyyy = d.getFullYear(); return `${dd}/${mm}/${yyyy}`; };
  </script>

</div>
<div id="legendWrap" x-show="selectedUniverse">
<button id="legend_bar" @click="showLegend = !showLegend" class="glass px-3 py-1.5 rounded-lg text-sm hover:bg-white/10 transition" id="legendToggle">BaÄŸlantÄ±lar <span x-text="showLegend ? '(Gizle)' : '(GÃ¶ster)'"></span></button>
<div id="legend" x-show="showLegend" x-transition="">
<h3 class="font-bold mb-2">BaÄŸlantÄ±lar</h3>
<ul>
<template :key="type" x-for="[type, color] in legendEntries">
<li class="flex items-center mb-1"><svg class="mr-2" height="8" width="36"><line :stroke="color" :stroke-dasharray="(edgeStyles[type]?.dashes ? edgeStyles[type].dashes.join(',') : '0')" stroke-width="3" x1="2" x2="34" y1="4" y2="4"></line></svg><span x-text="type"></span></li>
</template>
</ul>
</div>





<!-- Yeni panel aÃ§ma butonu -->
<button @click="panelOpen = !panelOpen" id="panel_bar" class="fixed right-4 bottom-4 z-50 glass rounded-full w-12 h-12 grid place-items-center hover:bg-white/10" title="Notlar ve Favoriler">ðŸ“</button>


<!-- Notlar & Favoriler Paneli -->
<div class="fixed right-4 bottom-20 z-50 glass rounded-xl p-4 w-[22rem] max-h-[45vh] overflow-y-auto text-white text-sm space-y-4"
     x-show="panelOpen" x-transition>

  <!-- Sekmeler -->
  <div class="flex gap-2 mb-1">
    <button id="fav_bar" @click="activeTab = 'watch'" :class="activeTab === 'watch' ? 'bg-white/20 px-3 py-1 rounded' : 'px-3 py-1 rounded hover:bg-white/10'">â­ Favoriler</button>
    <button id="notlar_bar" @click="activeTab = 'notes'" :class="activeTab === 'notes' ? 'bg-white/20 px-3 py-1 rounded' : 'px-3 py-1 rounded hover:bg-white/10'">ðŸ“ Notlar</button>
  </div>

  <!-- Favoriler Sekmesi -->
  <div x-show="activeTab === 'watch'" class="space-y-3">
    <template x-if="!watchLater.length">
      <p class="text-sm opacity-70">HenÃ¼z favori yok.</p>
    </template>

    <template x-for="item in watchLater" :key="item.id">
      <div class="border border-white/10 rounded-lg overflow-hidden">
        <div class="flex justify-between items-center px-3 py-2 bg-white/10">
          <span class="font-semibold truncate" x-text="item.label || item.id"></span>
          <button @click="removeWatchLater(item.id)" class="text-red-400 hover:text-red-600 text-xs">Sil</button>
        </div>
      </div>
    </template>
  </div>

  <!-- Notlar Sekmesi -->
  <div x-show="activeTab === 'notes'" class="space-y-3">
    <template x-if="!Object.keys(notes).some(k => notes[k]?.length)">
      <p class="text-sm opacity-70">Not bulunamadÄ±.</p>
    </template>

    <template x-for="(entries, nodeId) in Object.fromEntries(Object.entries(notes).filter(([k, arr]) => arr.length))" :key="nodeId">
      <div class="border border-white/10 rounded-lg overflow-hidden">
        <button @click="notesOpen = notesOpen === nodeId ? null : nodeId" class="w-full text-left px-3 py-2 bg-white/10 hover:bg-white/20 font-semibold">
          <span x-text="nodes.get(nodeId)?.label || nodeId"></span>
        </button>

        <div x-show="notesOpen === nodeId" x-transition class="p-3 space-y-2 max-h-[45vh] overflow-y-auto">
          <template x-for="(n, i) in entries" :key="i">
            <div class="bg-white/10 p-2 rounded">
              <div class="text-xs opacity-70 mb-1" x-text="new Date(n.ts).toLocaleDateString()"></div>

              <template x-if="editingNoteIndex === `${nodeId}_${i}`">
                <div class="flex flex-col gap-2">
                  <textarea x-model="editedNoteText" class="w-full p-2 rounded bg-black/20 text-sm text-white border border-white/20"></textarea>
                  <div class="flex justify-end gap-2 text-xs">
                    <button @click="saveEditedNote(nodeId, i)" class="px-2 py-1 rounded bg-green-600 hover:bg-green-700 text-white">Kaydet</button>
                    <button @click="cancelEditNote()" class="px-2 py-1 rounded bg-white/20 text-white">VazgeÃ§</button>
                  </div>
                </div>
              </template>

              <template x-if="editingNoteIndex !== `${nodeId}_${i}`">
                <div>
                  <div class="whitespace-pre-wrap text-sm mb-1" x-text="n.text"></div>
                  <div class="flex justify-end gap-2 text-xs opacity-80">
                    <button @click="startEditNote(`${nodeId}_${i}`, n.text)">âœï¸</button>
                    <button @click="deleteNote(nodeId, i)">ðŸ—‘ï¸</button>
                  </div>
                </div>
              </template>
            </div>
          </template>
        </div>
      </div>
    </template>
  </div>
</div>
        </template>
      </div>
    </template>
  </div>
</div>

</body>
</html>
